# 設計原則（絶対厳守）

**このファイルは、AI実装時に必ず参照すること。**

---

## 1. UI/UXの一貫性

### 1.1 ログイン機能

**ログインUIは1種類のみ使用すること。**

- **使用するコンポーネント**: `components/common/LoginModal.tsx`
- **使用箇所**: ホーム、チャレンジ、マイページ、その他すべての画面
- **禁止事項**:
  - 青いバナーなど、別のログインUIを作成しない
  - ログイン機能を複数の場所で重複実装しない
  - `LoginConfirmModal`、`LoginButton`など、類似コンポーネントを作成しない

**新しいログインボタンを作成する前に**:
1. `components/common/LoginModal.tsx` を確認
2. 既存の `LoginModal` を再利用できないか検討
3. 再利用できる場合は、必ず既存コンポーネントを使用

---

### 1.2 コンポーネントの再利用

**新しいコンポーネントを作成する前に、既存コンポーネントを検索・再利用すること。**

#### 実装前のチェックリスト
1. **検索**: `match` ツールで `components/` ディレクトリ全体を検索
2. **確認**: 既存のコンポーネントで代用できないか確認
3. **再利用**: 代用できる場合は、既存コンポーネントを使用
4. **共通化**: 新しいコンポーネントを作成する場合、共通化できるか検討

#### 共通コンポーネントの配置
- **共通コンポーネント**: `components/common/` に配置
- **UI部品**: `components/ui/` に配置
- **機能別コンポーネント**: `components/organisms/` または `features/` に配置

---

## 2. コードの品質と保守性

### 2.1 コンポーネントの独立性

**各コンポーネントは独立してテスト可能であること。**

- **スタイルのカプセル化**: スタイルをコンポーネント内に閉じ込める
- **グローバル依存の排除**: グローバルスタイル（`styles.ts`）に依存しない
- **Props の明確化**: Props の型定義を明確にする

---

### 2.2 依存関係の整理

**変更の影響範囲が明確になるよう、コンポーネント間の依存関係を整理すること。**

- **循環参照の禁止**: コンポーネント間の循環参照を避ける
- **依存関係の最小化**: 不要な依存関係を削除する
- **インポートの整理**: 使用していないインポートを削除する

---

## 3. 実装前の必須手順

### 3.1 既存実装の確認

**新しい機能を実装する前に、以下を確認すること:**

1. **同じ機能が既に実装されていないか？**
   - `match` ツールで検索
   - `docs/COMPONENT_REGISTRY.md` を確認

2. **既存のコンポーネントを再利用できないか？**
   - `components/` ディレクトリを検索
   - 類似コンポーネントを探す

3. **新しいコンポーネントを作成する場合、共通化できるか？**
   - 他の画面でも使用できるか検討
   - 共通化できる場合は `components/common/` に配置

---

### 3.2 設計原則の確認

**実装前に、このファイル（`DESIGN_PRINCIPLES.md`）を読むこと。**

- **違反していないか確認**: 実装内容が設計原則に違反していないか確認
- **不明点があれば質問**: 設計原則に不明点があれば、ユーザーに質問

---

## 4. 実装後の必須手順

### 4.1 重複チェック

**実装後、同じ機能を持つコンポーネントが複数存在しないか確認すること。**

- **検索**: `match` ツールで類似コンポーネントを検索
- **統合**: 重複がある場合は、統合する

---

### 4.2 コンポーネントレジストリの更新

**新しいコンポーネントを作成した場合、`docs/COMPONENT_REGISTRY.md` に追加すること。**

- **パス**: コンポーネントのファイルパス
- **用途**: コンポーネントの用途
- **使用箇所**: コンポーネントが使用されている場所

---

## 5. 禁止事項

### 5.1 絶対に禁止

- **ログインUIを複数作成しない**: `LoginModal` のみ使用
- **同じ機能を複数の場所で実装しない**: 共通化すること
- **グローバルスタイルに依存しない**: コンポーネント内でスタイルを完結させる
- **循環参照を作らない**: コンポーネント間の循環参照を避ける

---

### 5.2 推奨しない

- **その場しのぎの実装**: 長期的な保守性を考慮すること
- **過度な抽象化**: 必要以上に抽象化しない
- **過度な最適化**: 早すぎる最適化は避ける

---

## 6. AIへの指示

### 6.1 実装前

- **コンポーネント作成前**: 必ず `match` ツールで既存コンポーネントを検索
- **実装前**: `DESIGN_PRINCIPLES.md` を読む
- **実装前**: `docs/COMPONENT_REGISTRY.md` を確認

---

### 6.2 実装後

- **実装後**: `DESIGN_PRINCIPLES.md` に違反していないか確認
- **実装後**: `docs/COMPONENT_REGISTRY.md` を更新
- **チェックポイント前**: 重複実装がないか確認

---

## 7. 定期的なチェック

### 7.1 週次チェック

**週に1回、以下をチェックすること:**

1. **重複実装がないか**: `match` ツールで検索
2. **設計原則に違反していないか**: このファイルを再確認
3. **コンポーネントレジストリが最新か**: `docs/COMPONENT_REGISTRY.md` を更新

---

### 7.2 チェックポイント前のチェック

**`webdev_save_checkpoint` を実行する前に、以下をチェックすること:**

1. **DESIGN_PRINCIPLES.md に違反していないか？**
2. **COMPONENT_REGISTRY.md は最新か？**
3. **重複実装はないか？**

---

## 8. このファイルの更新

**このファイルは、プロジェクトの進行に合わせて更新すること。**

- **新しい設計原則**: 新しい設計原則が必要になった場合、このファイルに追加
- **禁止事項**: 新しい禁止事項が発生した場合、このファイルに追加
- **ベストプラクティス**: 新しいベストプラクティスが見つかった場合、このファイルに追加

---

**最終更新**: 2026-01-31
