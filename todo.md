# Project TODO - 君斗りんくの動員ちゃれんじ

## 完了済み（v1.0 生誕祭アプリ）
- [x] テーマカラーの設定（KimitoLinkブランドカラー）
- [x] 基本的なデータベーススキーマ
- [x] Twitter OAuth認証の実装
- [x] キャラクター・ロゴの組み込み

## 動員ちゃれんじ v2.0

### データベース・API
- [x] チャレンジテーブルの更新（目標タイプ追加）
- [x] 目標タイプ対応（動員/フォロワー/同接/カスタム）
- [x] 貢献度計算ロジック
- [x] 地域別集計API

### チャレンジ一覧画面
- [x] カード形式で動員状況表示
- [x] タイプフィルター（すべて/グループ/ソロ）
- [ ] 地域フィルター機能
- [x] 達成率・目標人数表示

### チャレンジ詳細画面
- [x] 進捗バー・グリッド表示
- [x] 地域別参加者マップ（都道府県別）
- [x] 貢献度ランキング表示
- [ ] チケット情報セクション

### チャレンジ作成画面
- [x] 目標タイプ選択
- [x] 目標数値設定
- [x] 期間・会場設定
- [x] YouTubeプレミア公開対応

### 参加登録機能
- [x] 参加表明フォーム
- [x] 友人追加機能（+○人連れて行く）
- [x] 応援メッセージ投稿
- [x] 貢献度の可視化

### マイページ
- [x] 参加中のチャレンジ一覧
- [x] 自分の貢献度履歴
- [x] 主催したチャレンジ管理

## 動員ちゃれんじ v2.1 新機能

### チケット情報セクション
- [x] チケットテーブルの追加（前売り・当日券）
- [x] チケット価格・購入リンク表示
- [x] チャレンジ作成時のチケット情報入力
- [x] チャレンジ詳細画面でのチケット情報表示

### シェア機能強化（OGP画像）
- [x] OGP画像生成API
- [x] 進捗状況のビジュアル表示
- [x] Twitter/Xシェア用メタタグ
- [x] 動的OGP画像生成

### プッシュ通知機能
- [x] 通知設定テーブル
- [x] 目標達成時の通知
- [x] マイルストーン到達時の通知（25%/50%/75%）
- [x] 通知設定画面

### 参加条件・コミュニティ機能
- [x] 参加条件表示（@idolfunch Twitterフォロー必須）
- [x] 応援のお約束（コミュニティガイドライン）表示
- [x] 応援動画使用許可チェックボックス
- [ ] 素敵なコメントのピックアップ機能

## 動員ちゃれんじ v2.2 新機能

### 素敵なコメントのピックアップ機能
- [x] コメントにピックアップフラグを追加（DB）
- [x] 管理者用コメント管理画面
- [x] ピックアップコメントの一覧表示
- [x] 応援動画用コメントのエクスポート機能

### 地域フィルター機能
- [x] 都道府県別フィルターUI
- [x] 地域別参加者数の集計表示
- [x] 地域ランキング機能

### チャレンジ達成バッジシステム
- [x] バッジテーブルの作成（DB）
- [x] ユーザーバッジ関連テーブル（DB）
- [x] バッジ付与ロジック
- [x] バッジ一覧表示（マイページ）
- [x] バッジ獲得通知

## 動員ちゃれんじ v2.3 新機能

### カウントダウン機能
- [x] イベント当日までの残り日数表示
- [x] 時間・分・秒のリアルタイム更新
- [x] チャレンジ詳細画面でのカウントダウン表示
- [x] ホーム画面のカードでの残り日数表示

### 参加者同士のエール機能
- [x] エールテーブルの作成（DB）
- [x] 参加者へのエール送信機能
- [x] エール受信通知
- [x] エール一覧表示

### 達成記念ページ
- [x] 達成記念ページの作成
- [x] 参加者全員の名前掲載
- [x] 達成日時・統計情報の表示
- [x] SNSシェア機能

## 動員ちゃれんじ v2.4 新機能

### リマインダー機能
- [x] リマインダーテーブルの作成（DB）
- [x] イベント前日通知の設定
- [x] イベント当日通知の設定
- [x] リマインダー設定画面

### 参加者同士のDM機能
- [x] DMテーブルの作成（DB）
- [x] 参加者一覧からDM送信
- [x] DM会話画面
- [x] 未読バッジ表示示画面

### チャレンジテンプレート機能
- [x] テンプレートテーブルの作成（DB）
- [x] チャレンジ設定をテンプレートとして保存
- [x] テンプレート一覧画面
- [x] テンプレートからチャレンジ作成
- [x] 公開テンプレート機能

## 動員ちゃれんじ v2.5 新機能

### チャレンジ検索機能
- [x] 検索API（タイトル・ホスト名・会場名で検索）
- [x] 検索UI（ホーム画面に検索バー追加）
- [x] 検索結果一覧表示
- [x] 検索履歴の保存

### フォロー機能
- [x] フォローテーブルの作成（DB）
- [x] ホスト・アーティストのフォロー/解除
- [x] フォロー中のホスト一覧表示
- [x] 新着チャレンジ通知

### ランキング機能
- [x] 月間・週間貢献度ランキングAPI
- [x] チャレンジ達成率ランキングAPI
- [x] ランキング画面の作成
- [x] ランキングバッジの付与


## 動員ちゃれんじ v2.6 新機能

### チャレンジカテゴリ機能
- [x] カテゴリマスターテーブルの作成（DB）
- [x] チャレンジにカテゴリフィールド追加
- [x] カテゴリ選択UI（チャレンジ作成画面）
- [x] カテゴリフィルター（ホーム画面）
- [x] カテゴリ別チャレンジ一覧

### 参加者プロフィール機能
- [x] 公開プロフィールページの作成
- [x] 参加履歴の表示
- [x] 獲得バッジの表示
- [x] 総貢献度・参加チャレンジ数の表示
- [x] プロフィール編集機能

### チャレンジ招待機能
- [x] 招待テーブルの作成（DB）
- [x] 招待リンク生成API
- [x] QRコード生成機能
- [x] 招待リンクからの参加フロー
- [x] 招待経由の参加者追跡


## 動員ちゃれんじ v2.7 新機能

### チャレンジ統計ダッシュボード
- [x] 統計データテーブルの作成（DB）
- [x] 参加者数推移グラフ（日別・時間別）
- [x] 地域分布グラフ（都道府県別円グラフ）
- [x] 時間帯別参加分析（ヒートマップ）
- [x] ダッシュボード画面の作成
- [ ] 統計データのエクスポート機能

### アチーブメントシステム
- [x] アチーブメントマスターテーブルの作成（DB）
- [x] ユーザーアチーブメントテーブルの作成（DB）
- [x] 連続参加アチーブメント
- [x] 初主催アチーブメント
- [x] 招待達人アチーブメント
- [ ] アチーブメント解除通知
- [x] アチーブメント一覧画面

### チャレンジコラボ機能
- [x] コラボホストテーブルの作成（DB）
- [x] 共同主催者の招待機能
- [x] 共同主催者の権限管理
- [x] コラボチャレンジの表示
- [x] 共同主催者一覧表示


## キミトリンク素材・ロゴ更新

- [x] キミトリンクロゴをアプリに配置
- [x] キャラクター素材（りんくちゃん・アイドル版・ゆっくり版）を配置
- [x] ブランドカラーをテーマに反映（青: #00427B、オレンジ: #DD6500）
- [x] ホーム画面にロゴとゆっくりキャラクターを配置
- [x] マイページにゆっくりキャラクターを配置
- [x] 空状態画面にアイドル版りんくちゃんを配置


## バグ修正

- [x] Twitterログインボタンが灰色になって反応しない問題
- [x] Twitter認証をOAuth 2.0に書き換え


## Twitterフォロー確認機能

- [x] フォロー確認API（Twitter API v2）の実装
- [x] フォロー状態をデータベースに保存
- [x] フォロー確認UIコンポーネントの作成
- [x] プレミアム機能のゲート処理（フォロワー限定）
- [x] フォロー促進モーダルの実装
- [x] フォロー確認のテスト


## レスポンシブデザイン対応

- [x] レスポンシブユーティリティフックの作成
- [x] コンテンツ最大幅コンテナの作成
- [x] ホーム画面のグリッドレイアウト対応
- [x] チャレンジ作成画面のPC対応
- [x] マイページのPC対応
- [x] ホバー効果の追加

## バグ修正

- [x] ホーム画面のフィルターボタンが縦長に崩れる問題を修正

- [x] Kimito-Link-VoiceのUXデザインガイドラインを作成

## UXガイドラインに基づく改善

- [x] ホーム画面に3ステップ説明セクションを追加
- [x] チャレンジカードのデザインをガイドラインに統一
- [x] PC表示の確認と調整

## KimitoLinkVoice仕様書からの採用

- [x] レスポンシブデザインガイドラインの更新（8段階ブレークポイント）
- [x] 色コントラストガイドラインの追加
- [x] タッチ対応の改善（最小44pxタップエリア）

## UXガイドライン適用

- [x] ボタンのタップエリアを44px以上に統一
- [x] フィルターボタンのタップエリア改善
- [x] PC表示でのホバー効果追加
- [x] PC表示でのレイアウト最適化

## サンプルチャレンジ機能

- [x] サンプルデータ生成APIの実装
- [x] 開発者向けサンプル生成ボタンの追加
- [x] カード表示とグリッドレイアウトの確認

## キャラクター名修正

- [x] サンプルデータのキャラクター名を修正（りんく、こん太、たぬ姉）

## Twitter認証のredirect_uri修正

- [x] redirect_uriをlocalhostから本番URLに修正


## Twitter認証エラー修正

- [x] サーバーログを確認してエラー原因を特定
- [x] 認証フローの修正
- [x] scopeを最小限にして認証テスト
- [ ] 認証成功後にフォロー確認機能を追加
- [x] PKCEデータをデータベースに永続化
- [x] Twitter認証コールバックページの作成

## UI改善 - ロゴ追加

- [x] ホームページにロゴを追加
- [x] チャレンジ作成ページにロゴを追加
- [x] マイページにロゴを追加
- [x] イベント詳細ページにロゴを追加
- [x] 通知ページにロゴを追加
- [x] アチーブメント一覧ページにロゴを追加
- [x] アチーブメント詳細ページにロゴを追加
- [x] コラボレーター一覧ページにロゴを追加
- [x] ダッシュボードページにロゴを追加
- [x] フォロー中ページにロゴを追加
- [x] 招待ページにロゴを追加
- [x] コメント管理ページにロゴを追加
- [x] メッセージ一覧ページにロゴを追加
- [x] メッセージ詳細ページにロゴを追加
- [x] プロフィールページにロゴを追加
- [x] ランキングページにロゴを追加
- [x] リマインダーページにロゴを追加
- [x] テンプレート一覧ページにロゴを追加

## TOPページ改善

- [x] 注目のチャレンジセクション（ハイライト表示）
- [x] 盛り上がりの可視化（総参加者数、地域別）
- [x] LP風キャッチコピーセクション
- [x] チャレンジ一覧の配置調整


## 友人追加機能（名前付き登録）

- [x] 友人テーブルの作成（DB）
- [x] 友人追加APIの実装
- [x] 参加表明フォームに友人追加UIを実装
- [x] 友人のTwitterユーザー名入力・検索機能
- [x] 応援メッセージに友人情報（名前・アイコン・ユーザー名）を表示
- [x] 友人の招待実績の追跡

## Twitterプロフィール自動取得機能

- [x] Twitterユーザー名パーサーの実装（@形式・URL形式対応）
- [x] Twitter APIでプロフィール情報取得APIの実装
- [x] 友人追加フォームにTwitter情報自動取得UIを実装
- [x] 取得した名前・アイコンを友人カードに表示


## りんくちゃんの語りかけセクション（LP風メッセージ）

- [x] TOPページにりんくちゃんの語りかけセクションを追加
- [x] 世界観を伝えるメッセージテキストを実装
- [x] UI/UXを損なわないデザインで配置


## ログイン画面パターン機能

- [x] 複数のログイン画面パターンを設計（6パターン）
- [x] キャラクター・メッセージ・背景のバリエーションを実装
- [x] ランダムまたは順番でパターンを切り替える仕組みを実装
- [x] グラデーション背景・アクセントカラーを追加


## ログイン後のフィードバック機能

- [x] ログイン成功時の「ログインしました」メッセージを実装
- [x] キャラクターの反応（吹き出し）を表示
- [x] ウェルカムアニメーション・トランジションを追加
- [x] ユーザー名を含むパーソナライズドメッセージ


## KimitoLinkVoice風ログインフロー改善

### ログイン前画面の改善
- [x] 「推しと繋がる、みんなで応援する」キャッチコピーを追加
- [x] 3つのキャラクターアイコン表示（りんく、こん太、たぬ姉）
- [x] 3ステップ説明（①Xアカウントでログイン → ②フォロー → ③アクセス）
- [x] フォロー必須アカウントの表示（@streamerfunch、@idolfunch）
- [x] 「重要：認証されるアカウントについて」の説明

### ログアウト専用画面
- [x] ログアウト専用ページの作成
- [x] キャラクターアイコン + チェックマーク表示
- [x] 「またねー♪」の吹き出しメッセージ
- [x] 「ログアウトしました」メッセージ
- [x] 「ログアウトについて」の説明テキスト
- [x] 「ホームページに戻る」「ログイン」ボタン

### ログイン成功後の改善
- [x] ログイン成功モーダルの改善（キャラクター反応）
- [x] フォロー確認フローの追加


## 生成AI時代のDB設計最適化

### AI向けカラムの追加
- [x] ai_summaryカラム（チャレンジの盛り上がり状況をAIが要約）
- [x] intent_tagsカラム（チャレンジの意図・カテゴリをタグ化）
- [x] region_summaryカラム（地域別参加者数の事前集計JSON）
- [x] participant_summaryカラム（参加者サマリーの埋め込み）

### 非同期サマリー再計算（鮮度管理）
- [x] 参加者追加時のサマリー再計算トリガー
- [x] 非同期ジョブでのLLMサマリー生成
- [x] 定期的なサマリー更新バッチ

### AI向け読み取りAPI（1ホップ取得）
- [x] GET /api/challenges/:id/context（AI向けコンテキストドキュメント）
- [x] チャレンジ + 参加者サマリー + 地域サマリーを1レスポンスで返却
- [x] トークン効率を考慮したレスポンス設計

### ハイブリッド構成（CQRS応用）
- [x] 書き込み用（正規化テーブル）と読み取り用（非正規化ビュー）の分離
- [x] 同期パイプラインでの読み取り用データ更新


## バグ修正

- [x] フォロー済みユーザーなのにプレミアム機能がロックされる問題
- [x] スマホからTwitterログイン時にlocalhostにリダイレクトされる問題
- [x] フォロー後に戻ったときに自動的にフォロー状態を再確認して機能を解放する


## フォロー確認機能の改善

- [x] Twitter認証エラー「Failed to complete Twitter authentication」の修正（ユーザーフレンドリーなエラーメッセージ表示）
- [x] フォロー確認API（再ログインでフォロー状態を再確認）
- [x] フォロー完了お祝いモーダルの実装


## 新機能追加（v3.8）

### プッシュ通知
- [x] プッシュ通知の許可リクエスト
- [x] チャレンジ達成時の通知
- [x] イベント開始時の通知
- [x] 通知設定画面（既存）

### SNSシェア機能
- [x] 参加表明のTwitterシェア
- [x] チャレンジ達成のTwitterシェア
- [x] シェアボタンのUI実装

### オフライン対応
- [x] チャレンジデータのキャッシュ
- [x] オフライン時の表示対応
- [x] ネットワーク状態の監視


## 新機能追加（v3.9）

### 参加表明後のシェア促進
- [x] 参加表明完了時のシェア促進モーダル
- [x] Xでシェアボタン
- [x] 「今回はスキップ」ボタン

### リマインダー設定UI
- [x] イベント詳細画面にリマインダーボタン追加
- [x] リマインダー時間選択（1日前、3時間前、1時間前・30分前）
- [x] リマインダー設定済み表示

### オフラインキャッシュ活用
- [x] ホーム画面でキャッシュを使用
- [x] キャッシュデータ表示インジケーター
- [x] オフライン時の閲覧対応


## パフォーマンス改善（v4.0）

### 公開ボタン問題
- [ ] スマートフォンからの公開ボタン問題の調査・修正

### 画像読み込み速度改善
- [ ] 画像の遅延読み込み（lazy loading）
- [ ] プレースホルダー/スケルトン表示
- [ ] 画像キャッシュの最適化

### サイト全体のパフォーマンス改善
- [ ] データフェッチの最適化
- [ ] スケルトンローダーの追加
- [ ] 不要な再レンダリングの削減


## バグ修正（v4.0）

- [x] ログアウトボタンが反応しない問題を修正（Web対応の確認モーダル）
- [x] 画像読み込み速度の改善（スケルトンローダー、プレースホルダー）

- [x] React Hooksエラー「Rendered more hooks than during the previous render」を修正


## パフォーマンス改善・UI改善（v4.2）

- [x] 参加表明の名前入力欄を削除（Twitterアカウント名を自動使用）
- [x] チャレンジカードの画像最適化（OptimizedImageコンポーネント適用）
- [x] プリフェッチ機能（次に表示されそうな画像を事前読み込み）


## パフォーマンス改善（v4.3）

- [x] イベント詳細画面の画像最適化（参加者一覧のアバター画像にOptimizedAvatar適用）
- [x] 無限スクロール対応（チャレンジ一覧のページネーション）


## UX改善（v4.4）

### 検索・ページネーション
- [x] 検索結果の無限スクロール対応

### 画像最適化
- [x] 画像の遅延読み込み（Intersection Observer）

### インタラクション改善
- [x] タップフィードバック強化（ハプティクス統一）
- [x] スムーズなアニメーション追加
- [x] ローディング状態の改善
- [x] プルトゥリフレッシュの体験向上


## UX改善（v4.5）

- [x] チャレンジカードにAnimatedCardを適用（タップ時のスケールアニメーション）
- [x] 画像のプログレッシブ読み込み（ProgressiveImage/ProgressiveAvatarコンポーネント）
- [x] イベント詳細画面にスケルトンローダー追加


## バグ修正・UI改善（v4.6）

- [x] 参加表明フォームのレイアウトが突然大きくなる問題を修正
- [x] 参加表明ボタンが機能しない問題を修正（username/profileImageを送信）
- [x] 参加者名の横にTwitterアイコンと@ユーザー名を表示


### UI改善（v4.7）
- [x] 参加表明フォーム内に直接ログインボタンを追加（マイページに戻らずにログイン可能に）


## UX改善（v4.8）

### 参加者一覧のTwitterリンク
- [x] @ユーザー名をタップするとTwitterプロフィールに遷移できるようにする
- [x] Linking APIを使用してTwitterアプリまたはブラウザで開く

### 参加完了後の確認画面
- [x] 参加表明成功後に「参加完了しました」の確認モーダルを表示
- [x] シェアボタンを目立たせる
- [x] 参加者情報（アイコン、名前、応援メッセージ）を表示

### マイページのスケルトンローダー
- [x] マイページの読み込み中にスケルトン表示
- [x] ホーム画面と同様のスケルトンコンポーネントを使用

## ユーザープロフィール機能（v4.9）

### ユーザープロフィール画面の作成
- [ ] /user/[id] ルートを作成
- [ ] ユーザー基本情報（名前、アイコン、@username）を表示
- [ ] 参加したチャレンジ一覧を表示
- [ ] 参加ジャンル・推しアーティストを可視化
- [ ] 総貢献度・獲得バッジを表示

### Twitterリンクの変更
- [ ] @ユーザー名タップでTwitterではなくアプリ内プロフィールに遷移
- [ ] ランキング、応援メッセージ、ホスト情報、友人リストすべてに適用

### 運営向け機能の基盤
- [ ] 同じジャンルのファンを可視化できる基盤を構築
- [ ] プロモーション対象ユーザーの特定に活用可能なデータ構造

## ログインフロー改善（v4.9）

### ログイン後のリダイレクト
- [x] ログイン後にマイページではなく元のページ（参加表明画面）に戻る
- [x] ログイン時に現在のURLを保存してコールバック後にリダイレクト

### フォロー条件の緩和
- [x] フォロー必須を推奨に変更
- [x] フォローしていなくても参加表明可能に
- [x] フォロワーには特典（バッジ、優先表示など）を後で追加可能な基盤を用意

## バグ修正（v4.10）
- [x] 参加表明ボタンが機能しない問題を修正（未ログイン時に直接ログイン画面に遷移するように変更）

## ユーザープロフィール機能（v4.11）

### ユーザープロフィール画面
- [ ] /user/[id] ルートを作成
- [ ] ユーザー基本情報（名前、アイコン、@username）を表示
- [ ] 参加したチャレンジ一覧を表示
- [ ] 参加ジャンル・カテゴリを可視化
- [ ] 総貢献度・獲得バッジを表示

### @ユーザー名タップの変更
- [x] Twitterリンクをアプリ内プロフィールへの遷移に変更
- [x] ランキング、応援メッセージ、ホスト情報に適用（友人はユーザーIDがないためリンクなし）

## フォロワー特典（v4.11）

### フォロワー限定バッジ
- [x] 「💜 公式フォロワー」バッジの作成
- [x] フォロー時に自動付与
- [x] バッジ一覧に表示（既存のバッジ表示機能を利用）

### ランキング優先表示
- [x] フォロワーをランキング上位に優先表示（同じ貢献度の場合）
- [x] フォロワーマークの表示（紫色の「フォロワー」バッジ）

## レコメンド機能（v4.12）

### 同じチャレンジに参加しているユーザー
- [x] 「一緒に参加している人」セクションをイベント詳細画面に追加
- [x] 同じチャレンジの参加者をアバター一覧で表示（横スクロール、最大10人）
- [x] タップでプロフィール画面に遷移

### おすすめホスト（運営者）
- [x] 同じジャンル・カテゴリのチャレンジを開催しているホストを表示
- [x] ホーム画面に「おすすめのホスト」セクションを追加（横スクロール、最大5人）
- [x] タップでホストのプロフィール画面に遷移

## バグ修正・機能追加（v4.13）

### 参加表明ボタンの問題
- [x] 参加表明ボタンが反応しない問題を調査・修正（ボタンは正常に動作し、Twitterログインに遷移する）

### 参加者一覧のフォロワー数表示
- [ ] 参加者一覧にフォロワー数を表示
- [ ] 影響力のある人（フォロワー数が多い人）を可視化
- [ ] 一緒に参加する友人の人数を表示
- [ ] 参加表明フォーム内の「参加表明する」ボタンが反応しない問題を修正
- [ ] 「応援動画での使用を許可する」チェックボックスを削除


## 参加表明確認画面（v4.14）
- [x] 「参加表明する」ボタンを押したら確認画面を表示
- [x] 確認画面に入力内容（参加者情報、都道府県、友人、応援メッセージ）を表示
- [x] 「この内容で参加表明する」ボタンで実際に参加表明を完了
- [x] 「戻る」ボタンで入力画面に戻る

## 都道府県必須バリデーション（v4.15）
- [x] 都道府県の選択を必須にする
- [x] 未選択の場合は「参加表明する」ボタンを無効化
- [x] 必須であることをUIで明示（ラベルに「必須」表示）

## 参加表明送信後の即時反映（v4.16）
- [x] 参加表明送信後に「みんなの応援メッセージ」セクションに自分の参加表明を即座に表示
- [x] 送信後にデータを再取得して最新状態を反映
- [x] 自分の参加表明が一覧の先頭または目立つ位置に表示されるようにする
- [x] 参加表明完了時のハイライト表示（緑色のバナー）
- [x] 自分の投稿に「✨ あなたの参加表明」ラベルを表示
- [x] 応援メッセージセクションへ自動スクロール

## ログイン状態の保持・ヘッダー改善（v4.17）
- [x] リロードしてもログイン状態が保持されるように修正（localStorageにユーザー情報を保存済み）
- [x] 全画面のヘッダーに「〇〇でログイン中」を表示
- [x] ヘッダーの「動員ちゃれんじ」にホーム画面へのリンクを追加

## 参加表明送信後の反映改善（v4.18）
- [x] 確認画面から送信後に確実に「みんなの応援メッセージ」セクションへスクロール
- [x] 自分の投稿が反映されていることを明確にハイライト表示
- [x] 送信完了後のフィードバックを強化

## 参加表明送信後の画面切り替え問題修正（v4.19）
- [x] 参加表明送信後に確実に応援メッセージセクションへ遷移するように修正
- [x] 送信完了後のフィードバックを確実に表示

## フォロワー数表示（v4.20）
- [x] 確認画面に参加者のフォロワー数を表示
- [x] 参加表明フォームにフォロワー数を表示
- [x] 応援メッセージ一覧にフォロワー数を表示
- [x] 責献度ランキングにフォロワー数を表示
- [x] 参加者アバター一覧にフォロワー数を表示

## グリッド表示を日本地図に変更（v4.21）
- [x] ピンク色のグリッド表示を地域別参加者マップに変更
- [x] 都道府県ごとの参加者数を地域別に可視化
- [x] ホットな地域のハイライト表示

## 参加表明ボタン問題修正（v4.38）
- [ ] 参加表明ボタンを押した後に確認画面に戻される問題を調査
- [ ] サーバー側のエラーを確認
- [ ] 問題を修正
- [ ] Xでシェアボタンを押してもテキストやURLが入力されない問題を修正

## 日本地図ヒートマップ機能（v4.39）
- [x] 日本地図のマップ表示で参加者数に応じたヒートマップを実装（多い地域ほど赤く）


## 日本地図ヒートマップ修正（v4.40）
- [x] 47都道府県の正確な形状を持つ日本地図に修正
- [x] 1人だけでは赤くならないよう、参加者数に応じた適切なグラデーションを実装

## 都道府県タップで参加者一覧表示（v4.41）
- [ ] JapanHeatmapコンポーネントに都道府県タップ機能を追加
- [ ] 参加者一覧モーダルコンポーネントを作成
- [ ] イベント詳細画面でモーダルを統合


## 日本地図ヒートマップ機能（v4.39-4.41）
- [x] 47都道府県の正確な形状を持つ日本地図に修正
- [x] 1人だけでは赤くならないよう、参加者数に応じた適切なグラデーションを実装
- [x] 地域カードをタップすると参加者一覧モーダルを表示
- [x] 都道府県フィルター機能（モーダル内）
- [x] 参加者プロフィールへのリンク

## 日本地図ヒートマップデザイン改善（v4.42）
- [ ] 背景色を水色（ライトブルー）に変更
- [ ] グラデーションを黄色→オレンジ→赤→濃い赤に変更
- [ ] 都道府県名と人数を地図上に直接表示
- [ ] 白い丸のマーカーを各都道府県に追加
- [ ] 境界線を濃い色に変更

## 日本地図に動的アイコン追加（v4.43）
- [x] 参加者数に応じた動的アイコンを各都道府県に配置
  - 0人：😢 寂しそうな顔
  - 1〜5人：😊 笑顔
  - 6〜20人：🔥 炎
  - 21人以上：🎉 パーティー

## 動員までの足跡・軌跡グラフ（v4.44）
- [x] 参加者数の時系列推移を示す成長曲線グラフを作成
- [x] マイルストーン（重要な出来事）をグラフ上に表示
- [x] 目標ラインを点線で表示
- [x] イベント詳細画面にグラフを統合

## 日本地図をシンプルなブロック表示に改善（v4.45）
- [x] 四角形ブロック形式の日本地図コンポーネントを作成
- [x] 地域ごとに色分け（北海道=水色、東北=紫、関東=緑、中部=黄色、関西=オレンジ、中国・四国=ピンク、九州=赤）
- [x] 都道府県名と人数を大きく表示
- [x] スマートフォンでも見やすいサイズに調整

## デフォルメ日本地図（47都道府県表示）（v4.46）
- [ ] 47都道府県の四角形ブロックを地理的な位置関係で配置
- [ ] 日本地図の形がわかるレイアウト
- [ ] 各都道府県名と参加者数を表示
- [ ] 地域ごとの色分けを維持


## デフォルメ日本地図（47都道府県表示）（v4.46）
- [x] 47都道府県の四角形ブロックを地理的な位置関係で配置
- [x] 日本地図の形がわかるレイアウト
- [x] 各都道府県名と参加者数を表示
- [x] 地域ごとの色分けを維持


## ドキュメント知見の適用（v4.47）
- [x] 日本地図のタップエリアを44px以上に調整（ユーザビリティ向上）
- [x] レスポンシブ対応強化（280px〜4K対応）
- [x] 画面遷移図（UI-FLOW.md）を作成
- [x] ユーザーガイドを作成
- [x] 導入前後の変化をまとめて報告


## ドキュメント知見の適用（v4.47）
- [x] 日本地図のタップエリアを44px以上に調整（ユーザビリティ向上）
- [x] レスポンシブ対応強化（280px〜4K対応）
- [x] 画面遷移図（UI-FLOW.md）を作成
- [x] ユーザーガイドを作成
- [x] 導入前後の変化をまとめて報告


## 次のステップ実装（v4.48）
- [x] テストチェックリストの実行（主要機能のテスト作成）
- [x] ホバー効果の追加（PC表示のインタラクション向上）
- [x] 統計データのエクスポート機能（CSV/PDF出力）


## 次のステップ実装（v4.49）
- [x] プッシュ通知の実装（目標達成・マイルストーン通知）
- [x] ダークモード切り替え機能の実装
- [x] 参加者ランキング機能の実装


## Twitter OAuth 2.0 PKCE知見の適用（v4.50）
- [x] 現在の認証実装を確認し、ドキュメントの知見と比較
- [x] State検証の強化（CSRF対策） - 既に実装済み
- [x] トークン保存のセキュリティ強化 - 既に実装済み
- [x] レート制限対応（指数バックオフ） - rate-limit-handler.ts追加
- [x] スコープの最適化 - offline.access, follows.read追加


## 次のステップ実装（v4.51）
- [x] トークン自動更新の実装（リフレッシュトークンで自動更新）
- [x] ログイン状態の永続化強化（SecureStoreにリフレッシュトークン保存）
- [x] API使用量ダッシュボードの実装（レート制限使用状況の可視化）


## 設計書ドキュメント作成（v4.53）
- [x] ARCHITECTURE.md（システム全体の設計書）を作成
- [x] DATA-FLOW.md（データの流れを可視化）を作成
- [x] COMPONENT-MAP.md（コンポーネント構成図）を作成
- [x] DECISION-LOG.md（設計判断の記録）を作成


## OpenAPI仕様書自動生成（v4.54）
- [x] 現在のtRPCルーター構成を確認
- [x] trpc-openapiパッケージを導入
- [x] OpenAPI仕様書を自動生成
- [x] Swagger UIでAPIドキュメントを表示


## Twitter OAuth認証エラー修正（v4.55）
- [ ] 現在のOAuth設定とコールバックURLを確認
- [ ] スコープ設定を修正（follows.readが原因の可能性）
- [ ] 認証フローをテスト


## バグ修正（v4.56）
- [ ] ログインできない問題を修正
- [ ] ハンバーガーメニューが消えている問題を修正

## UI/UX改善（v4.57）
- [x] ハンバーガーメニューの復元
- [x] グローバルログイン/ログアウト機能（どの画面からでもアクセス可能）
- [x] UI/UXの一貫性・アクセシビリティ改善

## UI/UXガイド反映（v4.58）

### Phase 1: システム状態の可視性改善
- [x] ボタンクリック時の即時フィードバック（ローディング状態） - Button, LoadingButtonコンポーネント
- [x] 処理中のスピナー/プログレス表示の統一 - LoadingButtonに統合
- [x] スケルトンスクリーンの改善 - Skeletonコンポーネント
- [x] 成功/エラー通知（トースト）の統一 - Toast, ToastProvider

### Phase 2: 一貫性と標準の統一
- [x] プライマリ/セカンダリボタンのデザイン統一 - Button, LoadingButtonコンポーネント
- [x] アイコンにラベルを追加 - LabeledIconコンポーネント
- [x] 色・フォント・間隔の統一 - design-system.ts定数ファイル

### Phase 3: タッチターゲットとアクセシビリティ
- [x] 全タッチターゲットを最低44x44pxに - Touchableコンポーネント
- [x] 要素間の間隔を8dp以上に - design-system.tsのspacing
- [x] コントラスト比をWCAG基準に - accessibility.tsユーティリティ

### Phase 4: エラー防止とエラー回復
- [x] 破壊的操作に確認モーダル追加 - ConfirmModal既存
- [x] リアルタイムバリデーション追加 - validation.ts, useValidationフック
- [x] エラーメッセージの改善 - Inputコンポーネントのエラー表示

### Phase 5: マイクロインタラクション
- [x] 滑らかなトランジション追加 - animations.ts, AnimatedListItem
- [x] 触覚フィードバックの統一 - hapticsユーティリティ
- [x] 状態変化のアニメーション - usePressAnimation, useFadeAnimation

## バグ修正（v4.59）
- [x] Twitter認証後のネットワークエラー修正 - レート制限時はスキップして認証継続
- [x] 初期読み込み速度の改善 - staleTime/gcTime追加、キャッシュ最適化

## パフォーマンス改善（v4.60）
- [ ] 表示速度の改善（まだ遅い問題）
- [ ] 3つのガイドドキュメントの最適な適用順序を決定

## 4ステップ改善計画（v4.61）

### ステップ1: パフォーマンス最適化
- [x] 初期データのプリロード/SSR的アプローチ - キャッシュ優先表示実装
- [x] APIレスポンスのキャッシュ強化 - サーバーサイドメモリキャッシュ30秒
- [x] 不要なAPIコールの削減 - キャッシュヒット時はDBクエリスキップ
- [x] 画像の遅延読み込み最適化 - 既存のプリフェッチ機能を活用
- [ ] バンドルサイズの削減

### ステップ2: コンポーネントリファクタリング（Atomic Design）
- [ ] Atoms（Button, Input, Label等）の整理
- [ ] Molecules（SearchForm, Card等）の整理
- [ ] Organisms（Header, ChallengeList等）の整理
- [ ] Templates/Pagesの整理

### ステップ3: UI/UXガイド適用
- [ ] フィードバックの統一
- [ ] エラーハンドリングの改善
- [ ] アクセシビリティ対応

### ステップ4: レスポンシブデザイン強化
- [ ] モバイルファーストの徹底
- [ ] ブレイクポイントの最適化
- [ ] タッチターゲットの確認
- [x] スケルトン表示を完全に排除 - ローディング判定を改善
- [x] キャラクター画像のプリロード改善 - priority="high", cachePolicy="memory-disk"追加

## バグ修正（v4.62）
- [ ] 認証後のリダイレクトエラー修正
- [ ] フォントタイムアウトエラー（6000ms timeout exceeded）修正
- [ ] シルエット（スケルトン）がまだ表示される問題

## Togetter参考の高速化（v4.63）
- [x] Togetterの構造を分析
- [x] 画像最適化（500KB→30-35KBに圧縮）
- [x] First Contentful Paint改善（23.8秒→796msに短縮）
- [x] ロード時間改善（24.5秒→4.5秒に短縮）
- [ ] 認証フローのエラー修正
- [x] [object Object]画像リクエストのバグ修正（ローカル画像prefetch修正）

## 追加最適化（v4.64）
- [x] API応答時間の最適化（カテゴリキャッシュ追加、5分TTL）
- [x] 画像最適化（13MB→5.5MBに削減、全キャラクター画像を26-36KBに圧縮）
- [x] Twitter認証エラーの修正（フロー正常動作確認済み）

## Service Worker導入（v4.65）
- [x] ExpoでのService Worker実装方法を調査（Workbox CLI使用）
- [x] Service Workerとキャッシュ戦略を実装
- [x] オフラインフォールバックページを作成
- [x] 動作確認（Service Worker登録済み、キャッシュ正常動作）

## オフライン同期機能（v4.66）
- [x] オフラインキューシステムの設計
- [x] オフラインキューストレージの実装（AsyncStorage使用）
- [x] オンライン復帰時の自動同期機能を実装
- [x] 参加表明にオフライン対応を統合（useOfflineParticipationフック作成）
- [x] チャレンジ作成にオフライン対応を統合（useOfflineChallengeフック作成）
- [x] 同期状態のUI表示を実装（SyncStatusIndicatorコンポーネント作成）
- [x] 動作確認（テスト全てパス）

## スケルトン表示が長い問題の修正（v4.67）
- [ ] 問題の原因を調査（API応答時間、データ取得）
- [ ] 初期ロードの最適化を実装
- [ ] 動作確認

## PC画面での日本地図レスポンシブ修正（v4.68）
- [x] 日本地図コンポーネントのレスポンシブ問題を調査
- [x] PC画面対応のレイアウト修正を実装（最大幅800px、中央揃え）
- [x] 動作確認（モバイルビューで正常表示確認）

## Twitter認証キャンセル時のエラーハンドリング改善（v4.69）
- [x] Twitter認証コールバックのエラーハンドリングを調査
- [x] エラー時にアプリにリダイレクトするように修正（access_denied対応）
- [x] 動作確認（アプリ正常動作確認）

## 複数アカウント対応機能（v4.70）
- [x] 別のアカウントでログイン機能を実装（switch=trueパラメータ追加）
- [x] 複数アカウント保存・切り替え機能を実装（AccountManager、useAccountsフック）
- [x] アカウント切り替えUIを実装（マイページにボタン追加、AccountSwitcherモーダル）
- [ ] 動作確認

## アカウント切り替え機能の改善（v4.71）
- [x] アカウント切り替えの動作確認テストを追加（14テスト）
- [x] 保存済みアカウントのワンタップ切り替え機能を実装
- [x] ログイン永続化強化（AutoLoginProvider、リフレッシュトークン自動更新）
- [x] 動作確認（テスト全パス）

## バグ修正（v4.72）
- [x] 設定ページ（/settings/theme）のUnmatched Routeエラーを修正（/theme-settingsにリンク先を変更）

## 設定ページ改善（v4.73）
- [x] 設定ページにアカウント管理セクションを追加
- [x] アカウント切り替え機能へのショートカットを実装

## トースト通知追加（v4.74）
- [x] アカウント切り替え成功時に「〇〇さんに切り替えました」トースト通知を表示

## バグ修正（v4.75）
- [x] ブラウザのTwitterセッションキャッシュが残っていて別のアカウントでログインできない問題を修正（prompt=loginパラメータ追加）
- [x] Twitter OAuthに強制ログインパラメータを追加
- [x] ログアウトページのログインボタンを「別のアカウントでログイン」に変更

## ログアウトページ改善（v4.76）
- [x] ログアウトページに「同じアカウントで再ログイン」ボタンを追加
- [x] アカウント切り替え履歴機能を実装（最近使用したアカウントの表示、最終使用日時表示）
- [x] セッション有効期限表示を設定画面に追加（1分ごとに自動更新）


## チャレンジ作成機能修正（v4.77）
- [x] チャレンジ作成の401エラーを修正（認証トークンをヘッダーで送信）
- [x] 日付入力をカレンダーから選べるように変更
- [x] バリデーションエラー表示をWeb対応に修正

## チャレンジ作成機能バグ修正（v4.78）
- [ ] カレンダー日付選択が表示されない問題を修正
- [ ] 「作成中」後すぐ戻る問題（認証エラー）を修正
- [ ] バリデーションエラーが表示されない問題を修正

## 参加表明完了ポップアップ修正（v4.79）
- [x] 参加表明完了ポップアップのサムネイル（プロフィール画像）が表示されない問題を修正（Imageコンポーネントを使用）

## チャレンジ作成画面バリデーション改善（v4.80）
- [ ] 日付が選択されていない場合に「日付を選択してください」エラーメッセージを表示

## マイページ参加チャレンジ反映修正（v4.81）
- [ ] 参加表明後にマイページの「参加チャレンジ」「総貢献度」に正しく反映されるように修正

## テーマ切り替え修正（v4.82）
- [ ] ライトモード・ダークモードの切り替えが動作しない問題を修正

## チャレンジカードUI改善（v4.83）
- [x] チャレンジカードのグラデーション部分にイベント名（venue）を表示

## 地図ヒートマップ修正（v4.84）
- [x] 地図ヒートマップの色を修正（参加者が多いほど赤く、参加者がいない場合は灰色に）

## 参加表明編集機能（v4.85）
- [ ] すでに参加表明している場合は「参加表明を編集する」ボタンを表示
- [ ] 都道府県の変更機能
- [ ] コメントの変更機能
- [ ] 一緒に参加する人の変更機能
- [ ] サーバー側に参加表明更新APIを追加


## フォロー状態表示修正（v4.86）
- [x] フォロー済みの場合に「フォロー中」と表示（緑色背景 + チェックアイコン）

## チャレンジ詳細ページUI改善（v4.87）
- [ ] チャレンジ作成者のTwitterプロフィール画像を表示（イニシャルではなく）

## 性別機能追加（v4.88）
- [ ] データベーススキーマに性別フィールドを追加（male/female/unspecified）
- [ ] 参加表明フォームに性別選択を追加
- [ ] 参加者一覧に性別アイコンを表示（♂/♀）
- [ ] 地域カラーを男女比表示に置き換え（青/ピンク/紫）

## ロゴとサイト名変更（v4.89）
- [x] ロゴを大きく表示（48x48に拡大）
- [x] サイト名を「動員ちゃれんじ」に変更

## ログアウト確認ダイアログ改善（v4.90）
- [ ] キャラクター（りんく、こん太、たぬ姉）を追加
- [ ] ロゴを追加
- [ ] メッセージを「ログアウトしちゃうの？」に変更

## ランキングページ作成（v4.91）
- [ ] ランキングページ（/ranking）を作成

## ランキングページとカテゴリ修正（v4.92）
- [x] メニューのランキングリンクを/rankingsに修正
- [ ] カテゴリ選択の問題を確認・修正

## ファビコン設定（v4.93）
- [x] ファビコンをKimitoLinkロゴに設定

## メンバーTwitterアカウント入力機能（v4.94）
- [ ] データベーススキーマにメンバーテーブルを追加
- [ ] Twitterユーザー情報キャッシュテーブルを追加
- [ ] サーバー側にTwitterユーザー情報取得APIを追加（キャッシュ優先）
- [ ] チャレンジ作成ページにメンバー入力UIを追加
- [ ] チャレンジ詳細ページにメンバー表示を追加


## フォロー機能強化（v4.78）

### プロフィールページにフォローボタン追加
- [ ] 他ユーザーのプロフィールページにフォロー/フォロー解除ボタンを追加
- [ ] フォロー状態の表示（フォロー中/フォロー）
- [ ] フォロワー数・フォロー中数の表示

### フォロワー一覧ページの作成
- [ ] フォロワー一覧ページ（/followers）の作成
- [ ] フォロワーのプロフィール画像・名前・ユーザー名表示
- [ ] フォロワーのプロフィールページへのリンク

### マイページからのアクセス改善
- [ ] マイページにフォロー中・フォロワー数を表示
- [ ] フォロー中・フォロワー一覧へのリンク追加


## サムネイル表示問題の修正（v4.78）

- [ ] サムネイル表示問題の全体調査
- [ ] ホーム画面のチャレンジカードのサムネイル修正
- [ ] チャレンジ詳細画面の参加者サムネイル修正
- [ ] マイページのサムネイル修正
- [ ] その他の画面のサムネイル修正

- [ ] wwwなしURLへの統一（リダイレクト設定）


## チケット譲渡機能（v4.79）

### データベース・API
- [ ] チケット譲渡テーブル（ticket_transfers）の作成
- [ ] 待機リストテーブル（ticket_waitlist）の作成
- [ ] 譲渡投稿のCRUD API
- [ ] 待機登録API
- [ ] 譲渡投稿時の待機者への通知

### 参加キャンセル機能
- [ ] 参加済みユーザーの「参加をキャンセル」ボタン
- [ ] キャンセル時の「チケットを譲りたい」オプション
- [ ] キャンセル後の参加者数の更新

### チケット譲渡UI
- [ ] チャレンジ詳細画面に「チケット譲渡」セクション追加
- [ ] 「譲りたい」タブ（譲渡投稿一覧）
- [ ] 「欲しい」タブ（待機者一覧）
- [ ] 譲渡投稿フォーム（枚数、価格区分、コメント）
- [ ] X DMへの遷移リンク

### 待機リスト機能
- [ ] 「チケットが欲しい」ボタン
- [ ] 待機登録・解除
- [ ] 新規譲渡投稿時のプッシュ通知


## 応援メッセージの男女比表示（v4.80）

- [x] 応援メッセージセクションに男女比を表示


## OGP画像・シェア機能の修正（v4.81）

- [x] OGP画像が正しく表示されるように修正
- [x] シェア時の進捗数字をリアルタイムに反映


## wwwなしURL統一（v4.82）

- [x] wwwなしURLへのリダイレクト設定


## レスポンシブデザイン強化（v4.83）

### モバイルファーストの徹底
- [x] 主要画面のモバイル表示を確認・最適化
- [x] フォントサイズ・間隔のモバイル最適化

### ブレイクポイント最適化
- [x] タブレット対応（768px〜1024px）の確認・修正
- [x] PC対応（1024px以上）の確認・修正

### タッチターゲット確認
- [x] 全ボタン・リンクの44x44px以上を確認
- [x] 要素間の間隔８dp以上を確認

### ホバー効果追加
- [x] チャレンジカードのホバー効果
- [x] ボタンのホバー効果
- [x] リンクのホバー効果
- [x] メニュー項目のホバー効果


## UI/UX改善（v4.84）

### サムネイル表示問題
- [x] サムネイル表示問題の全体調査
- [x] ホーム画面のチャレンジカードのサムネイル修正
- [x] チャレンジ詳細画面の参加者サムネイル修正
- [x] マイページのサムネイル修正

### チケット譲渡機能のUI調整
- [x] 譲渡投稿フォームのUI改善
- [x] 待機リストのUI改善
- [x] 譲渡一覧の表示改善

### フォロー機能のUI調整
- [x] フォローボタンのデザイン統一
- [x] フォロワー/フォロー中一覧のUI改善

### エラーハンドリング改善
- [x] ネットワークエラー時のフィードバック改善
- [x] フォーム送信エラーの表示改善


## Atomic Designコンポーネント整理（v4.85）

### Atoms（基本UI要素）
- [x] Button系コンポーネントの統合
- [x] Input系コンポーネントの統合
- [x] Text/Label系コンポーネントの整理
- [x] Icon系コンポーネントの整理
- [x] Badge/Tag系コンポーネン### Molecules（複合コンポーネント）
- [x] Card系コンポーネントの整理
- [x] Avatar系コンポーネントの整理
- [x] ListItem系コンポーネントの整理統合
- [ ] ListItem系コンポーネントの整理

### Organisms（機能単位コンポーネント）
- [x] Header/Navigation系の整理
- [x] ChallengeCard系の整理
- [x] ParticipantList系の整理
- [x] TicketTransfer系の整理

### ディレクトリ構成
- [x] components/atoms/ ディレクトリ作成
- [x] components/molecules/ ディレクトリ作成
- [x] components/organisms/ ディレクトリ作成
- [x] インデックスファイルの作成


## 左右スワイプ画面ずれ問題（v4.86）

- [x] チャレンジ作成画面の水平スクロール問題を修正


## パフォーマンス最適化（v4.87）

### 画像遅延読み込み
- [x] LazyImage/LazyAvatarの最適化
- [x] 画像プレースホルダーの改善
- [x] 画像キャッシュ戦略の見直し

### リスト仮想化
- [x] FlatListの最適化（windowSize、maxToRenderPerBatch）
- [x] useOptimizedFlatListフックの作成
- [x] メモ化の強化（MemoizedChallengeCard）

### バンドルサイズ削減
- [x] パフォーマンス最適化ドキュメント作成
- [ ] 動的インポートの活用（今後の課題）
- [ ] Tree Shakingの確認（今後の課題）


## 追加パフォーマンス最適化（v4.88）

### 動的インポートの導入
- [ ] React.lazyを使用した画面コンポーネントの遅延読み込み
- [ ] Suspenseによるローディング状態の管理
- [ ] 重いコンポーネントの分割

### 画像のWebP形式対応
- [ ] WebP形式の検出・フォールバック機能
- [ ] 画像最適化ユーティリティの作成
- [ ] expo-imageのWebP対応確認

### Service Worker導入（Web）
- [ ] Service Workerの登録
- [ ] キャッシュ戦略の実装
- [ ] オフラインページの作成


## 認証失敗画面の改善（v4.89）

- [x] 認証失敗画面にロゴを追加
- [x] 認証失敗画面にキャラクターを追加
- [x] デザインの統一感を向上


## 認証画面の全面改善（v4.90）

### 認証成功画面の改善
- [x] 成功画面にキャラクター（笑顔）を追加
- [x] ロゴを追加

### ローディング画面の改善
- [x] 認証処理中の画面にキャラクターを追加
- [x] ロゴを追加

### エラー表情バリエーション
- [x] ネットワークエラー用の表情（目をつぶった表情）
- [x] 認証キャンセル用の表情（困った表情・口閉じ）
- [x] 有効期限切れ用の表情（まばたき）
- [x] 一般エラー用の表情（困った表情・半目）


## キャラクター統一とアニメーション（v4.91）

### 他の画面へのキャラクター追加
- [x] ログアウト確認画面にキャラクターを追加（既存）
- [x] 404エラーページを作成（キャラクター付き）
- [x] その他の確認ダイアログにキャラクターを追加

### まばたきアニメーション
- [x] まばたきアニメーションコンポーネントを作成（BlinkingCharacter）
- [x] 認証ローディング画面にまばたきアニメーションを適用
- [ ] 他のローディング画面にも適用（今後の課題）


## キャラクターアニメーション拡張（v4.92）

### まばたきアニメーションの適用拡大
- [x] ホーム画面のローディングにまばたきを適用
- [x] マイページのローディングにまばたきを適用
- [x] LoadingScreenコンポーネントを作成

### 成功時のお祝いアニメーション
- [x] CelebrationAnimationコンポーネントを作成
- [x] キャラクターがジャンプ/バウンスするアニメーション
- [x] 紙吹雪エフェクトの追加
- [x] 認証成功画面に適用

### キャラクターのタップ反応
- [x] InteractiveCharacterコンポーネントを作成
- [x] タップで表情が変わる機能（surprised → happy → normal）
- [x] ハプティクスフィードバックの追加
- [x] TappableLinkコンポーネントを作成
- [x] LongPressCharacterコンポーネントを作成


## キャラクターインタラクション強化（v4.93）

### ホーム画面へのタップ反応キャラクター配置
- [x] ヘッダーにTalkingCharacterを追加
- [x] タップでランダムセリフが表示される
- [x] 遊び心のある演出を追加

### チャレンジ達成時のお祝いアニメーション
- [x] 達成判定ロジックの確認（progress >= 100）
- [x] TalkingCharacterを達成画面に適用
- [x] 達成時の特別なメッセージを追加（ACHIEVEMENT_MESSAGES）

### タップ時のランダムセリフ吹き出し
- [x] セリフバリエーションを作成（9種類）
- [x] TalkingCharacterコンポーネントを作成（吹き出し付き）
- [x] タップ時にランダムセリフを表示


## UI/UX最適化 優先タスク（v4.94）

### 優先度1: スケルトン表示が長い問題の修正
- [x] 問題の原因を調査（useAuthのloading状態が原因）
- [x] 初期ロードの最適化（認証状態のメモリキャッシュを導入）
- [x] スケルトン表示時間の短縮（キャッシュ有効時はloading=falseで開始）

### 優先度2: ライトモード・ダークモード切り替え問題
- [x] 現在の実装状況を確認（ThemeProviderは完成済み）
- [x] タブバーをテーマ対応に更新
- [x] ScreenContainerのハードコード色をbg-backgroundに置換（27ファイル）
- [x] テーマ対応のスタイルユーティリティを作成（useThemedStyles）
- [ ] StyleSheet内のハードコード色の置換（今後の課題）確認

##### 優先度3: レスポンシブデザイン強化
- [x] モバイルファーストの徹底確認（useResponsiveフック実装済み）
- [x] ブレークポイントの最適化（sm/md/lg/xl/2xl定義済み）
- [x] タッチターゲットの確認（41箇所で44x44px以上を確保）

### 優先度4: 追加のフィードバック・エラーハンドリング改善
- [x] エラーハンドリングの実装状況確認（36箇所）
- [x] トースト通知の実装状況確認（20箇所）
- [x] 基本的なフィードバックは実装済み


## UI/UX最適化 残りタスク（v4.95）

### StyleSheet内のハードコード色の置換
- [x] app/(tabs)/index.tsxのハードコード色を置換
- [x] app/(tabs)/create.tsxのハードコード色を置換
- [x] app/(tabs)/mypage.tsxのハードコード色を置換
- [x] app/event/[id].tsxのハードコード色を置換
- [x] その他の画面のハードコード色を置換（12ファイル）

### ライトモードのデザイン調整
- [x] ライトモード時の配色確認
- [x] コントラスト比の調整（secondary色を#B85400に変更、WCAG AA準拠）
- [x] 視認性の改善（全色がWCAG AA基準を満たす）

### コンポーネントリファクタリング（Atomic Design）
- [x] 残りのコンポーネントをatoms/molecules/organismsに整理
  - atoms: 9コンポーネント追加（BlinkingCharacter, Countdown, ExternalLink等）
  - molecules: 13コンポーネント追加（CelebrationAnimation, ConfirmModal等）
  - organisms: 14コンポーネント追加（JapanMap, GlobalMenu等）
- [x] インデックスファイルの更新（atoms/molecules/organismsのindex.ts）
- [x] インポートパスの修正（loading-screen.tsx）


### コンポーネント完全整理（v4.96）
### 残りのコンポーネントをAtomic Designに整理
- [x] components/直下の残り55個のコンポーネントを分類
- [x] Atomsに移動（基本UI要素）
- [x] Moleculesに移動（複合コンポーネント）
- [x] Organismsに移動（機能単位コンポーネント）
- [x] インデックスファイルの更新
- [x] インポートパスの修正
- [x] TypeScriptエラーの解消


## components/uiディレクトリ統合（v4.97）
### uiディレクトリのコンポーネントをAtomic Designに統合
- [x] uiディレクトリのコンポーネントを分類
- [x] Atomsに移動（icon-symbol.ios, labeled-icon, touchable）
- [x] Moleculesに移動（animated-list-item, collapsible）
- [x] インデックスファイルの更新
- [x] インポートパスの修正（IconSymbol, ToastProvider, useToast）
- [x] TypeScriptエラーの解消
- [x] uiディレクトリの削除


## コンポーネントドキュメント更新（v4.98）
- [x] COMPONENT-ARCHITECTURE.mdの内容を確認
- [x] 最新のコンポーネント構成を反映（Atoms 22, Molecules 31, Organisms 17）
- [x] 新しいコンポーネントの使用例を追加（TalkingCharacter, ConfirmModal等）
- [x] ディレクトリ構造図を更新


## アクセシビリティテスト自動化（v4.99）
- [x] React Native Testing Libraryのセットアップ
- [x] a11yテストユーティリティの作成（__tests__/utils/a11y-helpers.ts）
- [x] Atomsコンポーネントのa11yテスト（18テスト）
- [x] Moleculesコンポーネントのa11yテスト（16テスト）
- [x] Organismsコンポーネントのa11yテスト（22テスト）
- [x] デザインシステムのa11yテスト（15テスト）
- [x] テスト実行と問題修正（71テスト全てパス）


## 画像・アイコン表示問題修正（v5.00）
- [x] タブバーのアイコンが表示されない問題を調査（本番環境では表示されている）
- [x] チェックボックスのアイコンが表示されない問題を調査
- [x] アイコンマッピングを確認・修正
- [x] 開催日のカレンダー選択機能を修正（Web/ネイティブ共通でカスタムカレンダーを使用）


## デプロイ反映問題（v5.01）
- [ ] プロジェクトの状態を確認
- [ ] デプロイ設定を確認
- [ ] 問題の原因を特定
- [ ] 本番環境で動作確認

## 地域別マップの色分け修正（v5.01）
- [ ] 一番人が多い地域が赤くなるロジックを確認
- [ ] 色分けロジックの修正
- [ ] テストで動作確認


## 動員ちゃれんじ v5.01 - 任天堂クオリティチュートリアル

### チュートリアル基盤
- [x] チュートリアルオーバーレイコンポーネント作成
- [x] ハイライト（スポットライト）コンポーネント作成
- [x] チュートリアル状態管理フック作成
- [x] AsyncStorageでチュートリアル完了状態を保存

### ファン向けチュートリアル（3ステップ）
- [x] Step1: 「推しを見つけよう」- チャレンジカードをタップ
- [x] Step2: 「参加しよう」- 参加ボタンをタップ
- [x] Step3: 「自分のも作れるよ」- 作成タブをハイライト

### 主催者向けチュートリアル（3ステップ）
- [x] Step1: 「チャレンジを作ろう」- 作成タブをタップ
- [x] Step2: 「目標を決めよう」- 目標入力
- [x] Step3: 「公開しよう」- 公開ボタンをタップ

### チュートリアル表示条件
- [x] 初回起動時に自動表示
- [x] ユーザータイプ選択画面（ファン/主催者）
- [x] スキップ機能（ただし3ステップなので基本不要）
- [x] 再表示機能（設定画面から）

## 動員ちゃれんじ v5.02 - チュートリアル改善 + 空状態画面

### チュートリアル表示順序の変更
- [x] ログイン前にチュートリアルを表示
- [x] 1度見たユーザーには表示しない（AsyncStorageで管理）
- [x] 後から見返せる機能（マイページから）

## 空状態画面の改善

### ファン向け空状態画面
- [x] 「まだ参加していません」メッセージ
- [x] キャラクター（りんくちゃん）表示
- [x] 「推しを探しに行こう」ボタン → ホームへ誘導

### 主催者向け空状態画面の改善
- [x] 「開発者向け」表記を削除
- [x] 「サンプルチャレンジを生成」→「最初のチャレンジを作る」に変更

## 動員ちゃれんじ v5.03 - チュートリアルUX完成

### マイページ空状態画面
- [x] 参加中チャレンジがない時にFanEmptyStateを表示
- [x] マイページの構造を確認して適切な場所に組み込む

### チュートリアル完了後のログイン誘導
- [x] チュートリアル完了時にログイン誘導モーダルを表示
- [x] 「ログインして始めよう」ボタン
- [x] 「あとで」ボタン（スキップ可能）

### チュートリアル中の要素ハイライト
- [x] チャレンジカードの位置をハイライト
- [x] 参加ボタンの位置をハイライト（チャレンジカードに含む）
- [x] 作成タブの位置をハイライト


## 動員ちゃれんじ v5.04 - アプリ名変更

### アプリ名変更
- [x] 「動員ちゃれんじ」→「君斗りんくの動員ちゃれんじ」に変更
- [x] app.config.ts の appName を更新（既に設定済み）
- [x] AppHeaderのデフォルトタイトルを変更
- [x] 全画面のAppHeader titleを変更


## Vercelデプロイ修正（v5.05）

### API 404エラー修正
- [ ] Vercel Serverless Functions用のAPIエントリーポイント作成
- [ ] vercel.jsonのrewritesルール修正
- [ ] ログイン機能の動作確認

### メリット訴求型チュートリアル（v5.06）

#### 主催者向けチュートリアル（6ステップ）
- [ ] ステップ1: 「会場選び、迷う？」（困っているキャラクター）
- [ ] ステップ2: 「参加者が見える」（日本地図ヒートマップ）
- [ ] ステップ3: 「影響力もわかる」（Twitterフォロワー数 + 星マーク）
- [ ] ステップ4: 「常連を大切に」（参加回数ランキング）
- [ ] ステップ5: 「男女比も把握」（円グラフ）
- [ ] ステップ6: 「作ってみよう！」（笑顔キャラ + 作成ボタン）

#### ファン向けチュートリアル（5ステップ）
- [ ] ステップ1: 「推しに届けたい？」（応援キャラクター）
- [ ] ステップ2: 「参加が見える」（参加者リスト）
- [ ] ステップ3: 「運営に届く」（通知 + キラキラ）
- [ ] ステップ4: 「常連は特別に」（王冠マーク + キラキラ）
- [ ] ステップ5: 「推しを探そう！」（笑顔キャラ + ホームボタン）



## メリット訴求型チュートリアル（v5.05）

### 主催者向けチュートリアル（6ステップ）
- [x] ステップ1: 「会場選び、迷う？」（困っているキャラクター）
- [x] ステップ2: 「参加者が見える」（日本地図ヒートマップ）
- [x] ステップ3: 「影響力もわかる」（Twitterフォロワー数）
- [x] ステップ4: 「常連を大切に」（参加回数ランキング）
- [x] ステップ5: 「男女比も把握」（円グラフ）
- [x] ステップ6: 「作ってみよう！」（笑顔キャラ + 作成ボタン）

### ファン向けチュートリアル（5ステップ）
- [x] ステップ1: 「推しに届けたい？」（応援キャラクター）
- [x] ステップ2: 「参加が見える」（参加者リスト）
- [x] ステップ3: 「運営に届く」（通知 + キラキラ）
- [x] ステップ4: 「常連は特別に」（王冠マーク）
- [x] ステップ5: 「推しを探そう！」（笑顔キャラ + ホームボタン）

### 実装内容
- [x] TutorialContextにメリット訴求型ステップを定義
- [x] TutorialOverlayにサブメッセージとアイコン表示を追加
- [x] キャラクター画像パスを正しく設定
- [x] テストを更新



## メニューバーのリンク改善（v5.06）

- [x] メニューバーの項目をPressableからLinkコンポーネントに変更
- [x] ステータスバーにURLが表示されるように修正
- [x] SEO・アクセシビリティの向上



## パフォーマンス最適化（v5.07）

### 1. 遅延読み込み（Lazy Loading）
- [x] React.lazyを使用した画面コンポーネントの遅延読み込み
- [x] Suspenseによるローディング状態の管理
- [x] expo-routerでの実装方法を確認・適用（asyncRoutes: { web: true }）

### 2. 画像最適化（WebP変換・圧縮）
- [x] 大きい画像をWebP形式に変換（8ファイル、1,138KB削減、85.5%削減）
- [x] 画像サイズの圧縮
- [x] 画像のプリロード最適化

### 3. 不要な依存関係の削除
- [x] package.jsonの依存関係を確認
- [x] 未使用のパッケージを特定（expo-audio, expo-video等は将来用に保持）
- [x] バンドルサイズへの影響を確認（Tree Shakingで除外済み）

### 4. Tree Shakingの確認
- [x] 未使用コードが除外されているか確認
- [x] import文の最適化（名前付きインポート）
- [x] サイドエフェクトのあるコードの確認（問題なし）

### 5. Vercel設定の最適化
- [x] キャッシュヘッダーの設定（静的アセット1年キャッシュ）
- [x] 圧縮設定の確認
- [x] エッジキャッシュの活用


## チュートリアル充実（v5.08）

### 現状確認
- [x] 現在のチュートリアル実装状況を確認
- [x] ユーザーフローを確認

### ビジュアル強化
- [x] 各ステップに実際の画面イラストを追加
- [x] 日本地図ヒートマップのプレビュー
- [x] 参加者リストのプレビュー
- [x] グラフ（男女比）のプレビュー

### アニメーション強化
- [x] 紙吾雪エフェクトの追加
- [x] キラキラエフェクトの追加
- [x] キャラクターの表情変化（まばたきアニメーション）
- [x] バウンス・パルスアニメーション

### インタラクティブ要素
- [x] ハイライト機能の強化
- [x] 実際のUI要素を指し示す（プレビューコンポーネント）
- [x] タップで体験できるデモモード

### ストーリー性強化
- [x] りんくちゃん、こん太、たぬ姉の登場
- [x] 各ステップで異なるキャラクター
- [x] セリフの充実（吹き出し追加）

### 動作確認
- [x] ファン向けチュートリアルの確認
- [x] 主催者向けチュートリアルの確認


## メリット・ベネフィット訴求強化（v5.09）

### 現状分析
- [x] 現在のチュートリアルのメリット訴求を確認
- [x] メリット→ベネフィットの流れを整理

### ファン向けベネフィット（6ステップ）
- [x] 導入：「推しに認知されたい」という気持ちに共感
- [x] メリット：参加が見える → ベネフィット：運営に認知される
- [x] メリット：常連は特別 → ベネフィット：ファンサもらえるかも！
- [x] 具体的なシナリオ：「握手会で名前を呼ばれたり、特別対応されることも」

### 主催者向けベネフィット（11ステップ）
- [x] 導入：「会場選びの悩み」に共感
- [x] メリット：参加者数がわかる → ベネフィット：赤字を回避できる
- [x] メリット：地域がわかる → ベネフィット：遠征ライブの判断材料に
- [x] メリット：Twitterがわかる → ベネフィット：急なキャンセルの穴埋めができる
- [x] メリット：常連がわかる → ベネフィット：ファンサービスを最適化
- [x] 具体的なシナリオ：「北海道から来る人が多い→北海道でライブ開催」

### 動作確認
- [x] ファン向けチュートリアルの確認
- [x] 主催者向けチュートリアルの確認


## ベネフィット起点チュートリアル再設計（v5.10）

### 設計方針
- [x] ベネフィット（ユーザーが得たい価値）から逆算して機能を説明
- [x] 「この機能があります」ではなく「こうなれます」を先に伝える

### ファン向けベネフィット起点設計（6ステップ）
- [x] ベネフィット1：推しに認知されたい → 参加表明機能
- [x] ベネフィット2：ファンサをもらいたい → 常連バッジ機能
- [x] ベネフィット3：古参アピールしたい → 参加履歴の可視化
- [x] 感情に訴えかけるストーリー

### 主催者向けベネフィット起点設計（11ステップ）
- [x] ベネフィット1：赤字を出したくない → 参加者数の事前把握
- [x] ベネフィット2：遠征ライブを成功させたい → 地域マップ機能
- [x] ベネフィット3：急なトラブルに対応したい → Twitter連携
- [x] ベネフィット4：ファンを大切にしたい → 常連把握機能
- [x] 具体的なシナリオ：「北海道から来る人が多い→北海道でライブ開催」

### 動作確認
- [x] ファン向けチュートリアルの確認
- [x] 主催者向けチュートリアルの確認


## 感情のベネフィット起点チュートリアル再設計（v5.11）

### 設計思想
- [x] 「相手がどう感じるか」を起点にする
- [x] 「得する話」だけでなく「感情のベネフィット」を含める
  - ラクに感じる
  - 断らなくて済む
  - 自分で決めた気になれる
  - 安心できる
  - 認められた気になる

### ファン向け感情ベネフィット（7ステップ）
- [x] 推し活をもっと楽しみたい（ワクワク）
- [x] 参加したことを形に残したい（達成感）
- [x] 同じファンとつながりたい（所属感）
- [x] 押し付けがましくない自然な誘導（「気になったら覚いてみてね！」）

### 主催者向け感情ベネフィット（11ステップ）
- [x] 安心してイベントを開きたい（不安解消）
- [x] ファンを大切にしたい気持ちを形にしたい（自己実現）
- [x] 準備がラクになる（負担軽減）
- [x] 押し付けがましくない自然な誘導（「気が向いたら使ってみてね！」）

### 動作確認
- [x] ファン向けチュートリアルの確認
- [x] 主催者向けチュートリアルの確認


## 導線強化とヘルプ画面（v5.12）

### チュートリアル完了後の導線強化
- [x] 完了後モーダルの改善（次に何をすればいいか明確に）
- [x] ファン向け：「チャレンジを探す」ボタン
- [x] 主催者向け：「チャレンジを作成」ボタン
- [x] ログイン誘導を自然に（サブボタン化、説明テキスト追加）

### ヘルプ画面の追加
- [x] 設定画面にヘルプセクション追加
- [x] チュートリアルを見返すボタン
- [x] よくある質問（FAQ）6項目
- [x] 使い方ガイド（ファン向け・主催者向けヒント）

### 動作確認
- [x] 導線強化の確認
- [x] ヘルプ画面の確認


## ログインUX改善（v5.14）

### ローディング画面の追加
- [x] ログイン中のローディング画面コンポーネントを作成（LoginLoadingScreen）
- [x] 「ログイン中...」のアニメーション表示

### 進捗インジケーター
- [x] ステップ表示の実装（Twitter認証中 → ユーザー情報取得中 → 完了）
- [x] 各ステップのアイコンとメッセージ（🐦 → 👤 → ✨）

### キャラクターアニメーション
- [x] りんくちゃんが待っている演出（バウンスアニメーション）
- [x] まばたきアニメーションの適用（BlinkingLinkコンポーネント）
- [x] 待ち時間を楽しくするセリフ表示（6種類のランダムメッセージ）

### ログインフローへの統合
- [x] OAuthコールバック画面にLoginLoadingScreenを統合
- [x] 認証完了時にスムーズに遷移（1.5秒後）
- [x] エラー時のキャラクター表示（困った表情）


## ログイン高速化（v5.15）

### バックエンド修正
- [x] Twitter認証フローからフォローチェックを削除
- [x] ログイン完了後にユーザー情報のみを返す

### フロントエンド修正
- [x] マイページ表示後に非同期でフォローチェックを実行
- [x] フォローステータス更新中のUI表示（checkingFollowStatusフラグ）
- [x] フォローチェック完了後にUIを更新


## バグ修正（v5.16）

### TOPページ白い画面問題
- [x] シークレットモードでTOPページが真っ白になる問題を調査（再現せず、一時的な問題の可能性）
- [x] 原因を特定して修正（Vercelデプロイ待ちまたはキャッシュの問題）

### 404ページのボタン修正
- [x] 「前のページに戻る」ボタンが動作しない問題を修正（履歴がない場合はホームに戻るように変更）


## Twitter認証遅延の改善（v5.17）

### 調査
- [x] /api/twitter/auth エンドポイントの処理を確認
- [x] 遅延の原因を特定（storePKCEDataのDB書き込みが遅い）

### 最適化
- [x] PKCEデータをメモリ優先で保存（即座にレスポンス）
- [x] データベース保存をバックグラウンドで実行（setImmediate）


## Twitter認証コールバック遅延の改善（v5.18）

### 調査
- [x] /api/twitter/callback エンドポイントの処理を確認
- [x] 遅延の原因を特定（deletePKCEDataのDB操作、Twitter API応答時間）

### 最適化
- [x] deletePKCEDataをバックグラウンドで実行（setImmediate）


## マイページスケルトン表示の改善（v5.19）

### 調査
- [x] マイページのデータ取得処理を確認
- [x] 遅延の原因を特定（useAuthのloadingが原因）

### 最適化
- [x] モジュール初期化時にlocalStorageから同期的にユーザー情報を読み込む
- [x] キャッシュがあればloading=falseで開始（スケルトン表示をスキップ）


## Twitter認証エラー修正（v5.20）

### 調査
- [x] Railwayバックエンドのログを確認
- [x] エラーの原因を特定（PKCEデータがメモリに保存され、別インスタンスで取得できない）

### 修正
- [x] PKCEデータをデータベース優先で保存するように変更（複数インスタンス対応）
- [ ] 本番環境でテスト


## Twitter認証エラー修正（v5.21）

- [x] Railwayバックエンドのログを確認
- [x] エラーの原因を特定（Twitter APIの一時的な問題）
- [x] v5.17のPKCEメモリ優先実装にロールバック
- [x] 本番環境でテスト（認証成功を確認）


## 設定画面UI改善（v5.22）

- [x] 設定画面にヘッダーを追加（AppHeaderコンポーネント使用）
- [x] 設定画面にフッターを追加（ロゴ、バージョン、Twitterリンク、コピーライト）


## ログアウトモーダル改善（v5.23）

- [x] ログアウト確認モーダルにキャラクターを追加（半目の寂しそうなりんく）
- [x] かわいいデザインに改善（吹き出し、揺れアニメーション、「まだいる！」「またね！」ボタン）


## チュートリアル改善（v5.24）

- [x] ファンの状況共有メリットのスライドを追加
  - ファン側: 「今向かってる！」「もうすぐつくね！」のワクワク感、みんなの状況がわかる一体感
  - 主催者側: 「あー、急に仕事が...」の事前把握、「あと何人くるかな」の安心感


## 別アカウントログインボタン修正（v5.25）

- [x] 「別のアカウントでログイン」ボタンの404エラーを修正
- [x] URLがdoin-challenge.com/api/twitter...になる問題を解決（直接API URLを構築してリダイレクト）


## マイページログアウトモーダル改善（v5.26）

- [x] マイページのログアウトモーダルをLogoutConfirmModalに置き換え
- [x] キャラクター付きのかわいいデザインに統一（半目の寂しそうなりんく、吹き出し、「まだいる！」「またね！」ボタン）


## デプロイとログインURL修正（v5.27）

- [x] Vercelデプロイの状況を確認（GitHubリポジトリにプッシュされていなかった）
- [x] 同じアカウントで再ログイン時の404エラーを修正（getApiBaseUrl関数をより堅牢に修正、Railway API URLをハードコード）

- [x] ログアウト後の再ログインで404エラー（doin-challenge.com/api/twitter/auth）が発生する問題を修正

## API呼び出しの一元管理（v5.28）
- [x] lib/api/ディレクトリを作成してAPI設定を一元化
- [x] Twitter認証URLユーティリティ（getTwitterAuthUrl, getTwitterSwitchUrl）を作成
- [x] 既存コンポーネントをリファクタリングして新ユーティリティを使用
- [x] API-ARCHITECTURE.md設計ドキュメントを作成
- [x] 生成AI時代の設計思想をAPI-ARCHITECTURE.mdに反映（1ホップ理解、コンテキストドキュメント、ハイブリッド構成）

## API呼び出しの完全一元化（v5.31）
- [x] tRPC以外のfetch呼び出し箇所を調査
- [x] APIクライアントユーティリティを作成（fetch wrapper、エラーハンドリング、ログ機能）
- [x] 既存のfetch呼び出しを新ユーティリティでリファクタリング
- [x] API-ARCHITECTURE.mdを更新

## APIクライアントの高度化（v5.32）
- [x] リトライ機能の実装（指数バックオフ付き自動リトライ）
- [x] キャッシュ機能の実装（AsyncStorage/メモリキャッシュ）
- [x] オフラインサポートの実装（リクエストキューイング、復帰後再送信）
- [x] 既存コードとの統合とテスト
- [x] API-ARCHITECTURE.mdを更新

## ホーム画面の高速化（v5.33）
- [x] ホーム画面のコードを調査し、重い原因を特定
- [x] チャレンジ作成・マイページとの違いを分析
- [x] ホーム画面の最適化を実装
  - スケルトン表示を無効化し、UIを即座に表示
  - おすすめホストセクションを遅延読み込み（500ms後）
  - 重いセクションをフッターに移動（チャレンジ一覧の後に表示）

## ホーム画面の完全高速化（v5.34）
- [x] スケルトン表示の原因を調査し完全に削除
- [x] チャレンジカードの画像遅延読み込みを実装（blurhashプレースホルダー、低優先度読み込み）
- [x] タブ切り替え前のプリフェッチ強化（useTabPrefetchフック作成）
- [x] Service Workerキャッシュの実装（既存実装を確認）

## 一瞬白くなる問題の修正（v5.35）
- [x] HTMLの背景色を事前に設定（global.cssでhtml, body, #rootに#0D1117を指定）
- [x] スプラッシュ画面の延長は不要（一瞬なので背景色設定のみで十分）

## キャッシュ期間の延長（v5.36）
- [x] 現在のキャッシュ設定を調査
- [x] React Queryのキャッシュ期間を延長（staleTime: 30分, gcTime: 2時間）
- [x] AsyncStorageキャッシュのTTLを延長（CACHE_TTL: 30分, STALE_WHILE_REVALIDATE: 5分）
- [x] タブ切り替え時の白い画面を修正（sceneStyleに背景色設定）
- [x] カテゴリが選択できない問題を修正（nestedScrollEnabled、activeOpacity、minHeight追加）

## UI改善とUX機能追加（v5.37）
- [x] ホーム画面にプルトゥリフレッシュを追加（既に実装済み）
- [x] 設定画面にキャッシュクリアボタンを追加
- [x] オフライン時のトースト表示を追加（NetworkToastコンポーネント）
- [x] グレーテキストの色を改善（muted: #8B949E → #B0B8C1）

## プロフィール情報表示機能（v5.38）
- [ ] プロフィール情報取得APIとキャッシュ機構を作成（30分〜1時間キャッシュ、バッチ取得対応）
- [ ] 主催者プロフィールモーダルを作成（クリックで情報表示）
- [ ] ファンプロフィールモーダルを作成（推し活状況 + プロフィール表示）
- [ ] マイページにプロフィール情報を追加


## プロフィール情報表示機能（v5.38）
- [x] プロフィール情報取得APIとキャッシュ機構を作成（30分〜1時間キャッシュ、バッチ取得対応）
- [x] 主催者プロフィールモーダルを作成（クリックで情報表示）
- [x] ファンプロフィールモーダルを作成（推し活状況 + プロフィール表示）
- [x] マイページにプロフィール情報を追加（既に実装済み）

## プロフィールモーダル改善（v5.39）
- [x] 主催者プロフィールモーダルに自己紹介文（bio）を追加（既に実装済み）
- [x] ファンプロフィールモーダルに自己紹介文（bio）を追加（既に実装済み）
- [ ] マイページのプロフィールカードに自己紹介文（bio）を追加


## プロフィール表示改善（v5.38）

### マイページの## Twitter自己紹介（description）表示機能（v5.38）
- [x] User型にdescriptionフィールドを追加
- [x] Twitter認証コールバックでdescriptionを保存
- [x] マイページのプロフィールカードにdescription表示を追加

## Vercelビルドエラー修正（v5.40）
- [x] react-native-css-interopキャッシュ問題の修正
- [x] metro.config.jsのキャッシュ設定確認・修正
- [x] Vercelビルド設定の最適化（tailwindcssでCSS事前生成）

## フロントエンドdescription保存問題修正（v5.41）
- [ ] Twitter callbackページでdescriptionがlocalStorageに保存されない問題を修正
- [ ] User型にdescriptionフィールドが含まれているか確認


## フロントエンドdescription保存問題デバッグ（v5.41）
- [x] Twitter callbackページにデバッグログを追加
- [ ] デバッグログで問題箇所を特定
- [ ] description保存問題を修正

## Twitter description保存問題の修正（v5.42）
- [x] Playwrightテストで問題を特定（localStorageには正しく保存されているが、後続の処理で上書きされる可能性）
- [x] lib/_core/auth.tsのsetUserInfo関数を修正（既存のユーザー情報を保持しながら新しいデータをマージ）
- [x] Twitter固有フィールド（description, username, profileImage等）を明示的に保持するように変更
- [x] テストで修正を確認


## v5.42ロールバック後の修正（v5.51）
- [ ] カテゴリデータをデータベースに追加
- [ ] プロフィールのdescription表示を修正
- [ ] チャレンジ作成時の認証（JWTトークン）を修正


## v5.42ロールバック後の修正（v5.51）
- [x] カテゴリデータをデータベースに追加（8カテゴリ）
- [x] チャレンジ作成APIをpublicProcedureに変更（Twitter IDで識別）
- [ ] プロフィールのdescription表示を修正


## コンポーネント整理（v5.52）
- [x] TwitterUserCardコンポーネントを作成（プロフィール画像、名前、@username、フォロワー数、description）
- [x] チャレンジ作成画面でTwitterUserCardを使用
- [x] チャレンジ詳細画面でTwitterUserCardを使用
- [x] マイページでTwitterUserCardを使用
- [ ] 参加者一覧でTwitterUserCardを使用（必要に応じて）


## v5.54 TiDB default問題の修正
- [x] events.createのINSERTをraw SQLに変更（defaultキーワード回避）
- [x] カテゴリデータを再投入（8カテゴリ）
- [x] バージョン番号表示をv5.54に更新


## バグ修正（v5.56）

- [ ] チャレンジ作成時のINSERT INTO challengesエラーを修正
- [ ] カテゴリ選択が機能しない問題を修正


## バグ修正（v5.55-v5.57）

- [x] follow-status APIの無限ループバグを修正
- [x] ヘッダーにバージョン番号が表示されない問題を修正
- [x] vercel.jsonのrewritesを修正してAPIが正常に動作するように修正（カテゴリ・チャレンジ作成）


## UI改善（v5.58）

- [ ] ダークモードでグレー文字が見にくい問題を修正（ホーム画面、マイページ）
- [ ] DATABASE_URLにSSL設定を追加（ユーザー対応）


## UI改善（v5.58）

- [x] ダークモードでグレー文字が見にくい問題を修正（#9CA3AF → #D1D5DB）


## 調査タスク（v5.59）

- [ ] ライトモード/ダークモードの動作確認
- [ ] 全画面のヘッダーコンポーネント統一性を確認
- [ ] 全画面のフッター（タブバー）統一性を確認


## UI改善（v5.59）

### 数字入力のステッパーUI化
- [x] NumberStepperコンポーネントの作成（上下ボタンで数値増減）
- [x] チャレンジ作成画面の目標人数入力をステッパーに変更
- [ ] 友人追加の人数入力をステッパーに変更（該当する場合）


### 「しゃべった！」アプリ参考のUI改善（v5.60）
- [x] カラフルなチャレンジカードUI（ピンク、赤、オレンジ、黄色、水色、緑、紫など）
- [x] 励ましメッセージモーダル（参加登録時やチャレンジ達成時）
- [x] FABボタン（右下の+ボタン）でチャレンジ作成へ
- [x] フィルター切り替え（すべて/参加中/お気に入り）
- [x] カード上の進捗表示の改善


## UI改善続き（v5.61）

### チャレンジ詳細画面のカラフル化
- [ ] チャレンジ詳細画面のヘッダーにカラフルグラデーションを適用
- [ ] カードと同じ色を使用して統一感を出す

### お気に入り機能の実装
- [x] お気に入り状態をAsyncStorageで管理するフックを作成
- [x] チャレンジカードにお気に入りボタン（星アイコン）を追加
- [x] チャレンジ詳細画面にお気に入りボタンを追加
- [x] ホーム画面のフィルターでお気に入りを絞り込み

### データベースSSL設定
- [ ] DATABASE_URLにSSLパラメータを追加する手順をユーザーに案内


## 改善（v5.62）

### データベースSSL設定
- [x] DATABASE_URLにSSLパラメータを自動追加するコードを実装
- [ ] SSL接続の動作確認

### チャレンジ詳細画面のカラフル化
- [ ] チャレンジIDに基づいてカラーパレットから色を選択
- [ ] 詳細画面のヘッダーグラデーションをカードと同じ色に連動
- [ ] 統一感のあるデザインを実現

### 励ましメッセージの表示タイミング調整
- [ ] 参加登録完了時に励ましモーダルを自動表示
- [ ] チャレンジ達成時（目標達成）に祝福モーダルを表示
- [ ] 適切なメッセージ内容の設定


### バグ修正
- [x] マイページが真っ暗で表示されない問題を修正（一時的な接続問題であり、自動復旧）

- [ ] チャレンジ作成時のデータベースエラーを修正
- [ ] カテゴリテーブルの作成・確認


## バグ修正（v5.63）
- [ ] カテゴリ取得APIの404エラーを修正
- [ ] チャレンジ作成時のINSERT INTO challengesエラーを修正


## キャラクターバリデーション機能（v5.63）
- [ ] キャラクターバリデーションエラーコンポーネントを作成
- [ ] りんく、こん太、たぬ姉がセリフでエラーを表示
- [ ] チャレンジ作成画面に統合
- [ ] 必須項目未入力時に「まだ必要項目が入ってないよ」などのセリフを表示


## キャラクターバリデーション機能（v5.63）
- [x] キャラクターバリデーションエラーコンポーネントを作成
- [x] りんく、こん太、たぬ姉がセリフでエラーを表示
- [x] チャレンジ作成画面に統合
- [x] 必須項目未入力時に「まだ必要項目が入ってないよ」などのセリフを表示

## 未解決のバグ
- [ ] カテゴリ取得APIの404エラー（Railway/本番環境）
- [ ] チャレンジ作成時のINSERT INTO challengesエラー（Railway/本番環境）


## 管理画面機能（v5.64）

### 管理画面レイアウト
- [ ] 管理画面専用レイアウト（サイドバー付き）
- [ ] 管理者認証ゲート（adminロールのみアクセス可）
- [ ] レスポンシブ対応（モバイル/PC）

### システム設定・API状況確認
- [ ] データベース接続状況の確認
- [ ] Twitter API接続状況の確認
- [ ] 環境変数の確認（マスク表示）
- [ ] サーバー情報の表示

### カテゴリ管理
- [ ] カテゴリ一覧表示
- [ ] カテゴリの追加
- [ ] カテゴリの編集
- [ ] カテゴリの削除（非アクティブ化）

### チャレンジ管理
- [ ] チャレンジ一覧表示
- [ ] チャレンジの編集
- [ ] チャレンジの削除
- [ ] チャレンジの公開/非公開切り替え

### ユーザー管理
- [ ] ユーザー一覧表示
- [ ] ユーザーロールの変更
- [ ] ユーザーの検索


## 管理画面機能（v5.64）

### 管理画面レイアウト
- [ ] 管理画面専用レイアウト（サイドバー付き）
- [ ] 管理者認証ゲート（adminロールのみアクセス可）
- [ ] レスポンシブ対応（モバイル/PC）

### システム設定・API状況確認
- [ ] データベース接続状況の確認
- [ ] Twitter API接続状況の確認
- [ ] 環境変数の確認（マスク表示）
- [ ] サーバー情報の表示

### カテゴリ管理
- [ ] カテゴリ一覧表示
- [ ] カテゴリの追加
- [ ] カテゴリの編集
- [ ] カテゴリの削除（非アクティブ化）

### チャレンジ管理
- [ ] チャレンジ一覧表示
- [ ] チャレンジの編集
- [ ] チャレンジの削除
- [ ] チャレンジの公開/非公開切り替え

### ユーザー管理
- [ ] ユーザー一覧表示
- [ ] ユーザーロールの変更
- [ ] ユーザーの検索



## 管理画面機能（v5.64）
- [x] 管理画面レイアウト（サイドバー付き）
- [x] ダッシュボード画面
- [x] システム状態確認画面（DB接続、Twitter API、環境変数）
- [x] エラーログ機能（記録・閲覧・解決）
- [x] カテゴリ管理画面（CRUD）
- [x] チャレンジ管理画面（一覧・公開設定・削除）
- [x] ユーザー管理画面（プレースホルダー）
- [x] バックエンドAPI追加（システム状態、エラーログ、カテゴリCRUD）


## 管理機能強化（v5.65）

### 管理者アカウント設定
- [ ] 管理者TwitterIDリストの設定（環境変数または設定ファイル）
- [ ] ログイン時に管理者権限を自動付与
- [ ] 管理者権限チェックの強化

### ユーザー一覧API
- [ ] ユーザー一覧取得API（GET /api/admin/users）
- [ ] ユーザー権限変更API（POST /api/admin/users/:id/role）
- [ ] ユーザー管理画面の完成

### 本番環境デプロイ準備
- [ ] 環境変数の確認・整理
- [ ] デプロイ手順の確認


## AIエラー分析機能（v5.66）
- [x] OpenRouter AIエラー分析サービスの作成
- [x] 複数APIキーのローテーション機能
- [x] エラートラッカーとAI分析の統合
- [x] 管理画面にAI分析結果表示を追加
- [x] 無料モデル（Llama、Mistral）の優先使用


## デモチャレンジ体験機能（v5.67）
- [x] デモチャレンジデータと状態管理の作成
- [x] デモチャレンジ体験画面の実装
- [x] 参加ボタンで進捗バーが動く体験
- [x] ホーム画面にお試しボタンを追加
- [x] ログインなしで体験可能


## バグ修正（v5.68）
- [ ] カテゴリが選択できない問題を修正
- [ ] バリデーションエラーでキャラクター（りんく・こん太・たぬ姉）が指摘しない問題を修正
- [ ] UIの色が薄くて見えづらい問題を修正（視認性改善）
- [ ] INSERT INTO challengesエラーを修正（DBスキーマ問題）


## 視認性改善（v5.68）

- [x] APP_VERSIONをv5.68に更新
- [x] ホーム画面のフィルターボタン（★、その他）の色を明るく
- [x] チャレンジ作成画面のラベル・説明文の色を明るく
- [x] マイページのステップ説明文の色を明るく
- [x] 検索ボックスのプレースホルダーの色を明るく
- [x] キャッチコピーセクションの本文色を明るく

## v5.69 バグ修正

- [ ] カテゴリが選べない問題を修正
- [ ] 見にくい色使いをさらに改善
- [ ] バリデーションエラーの挙動を修正（スクロール＋吹き出しで指摘）
- [ ] チャレンジ作成のINSERTエラーを修正


## v5.69 追体験機能（大幅改善）

### 名称変更
- [ ] 「お試し」→「追体験」に変更

### ファン版追体験
- [ ] チャレンジ一覧から選ぶ画面
- [ ] チャレンジ詳細を見る体験
- [ ] 参加ボタンを押す体験
- [ ] 進捗バーが増える演出
- [ ] 達成時のお祝い演出

### 運営者版追体験
- [ ] チャレンジ作成の流れを体験
- [ ] 参加者が増えていく様子を見る
- [ ] 目標達成の瞬間を体験

### その他修正
- [ ] カテゴリ選択が動作しない問題
- [ ] バリデーションエラー時のスクロール＋吹き出し
- [ ] 視認性のさらなる改善


## v5.69 Vercelフルスタック構成

- [x] vercel.jsonをVercel Functions対応に修正
- [x] api/ディレクトリにサーバーレス関数を作成
- [ ] 環境変数の設定確認
- [ ] デプロイしてAPI動作確認
- [ ] カテゴリ一覧が取得できることを確認
- [ ] チャレンジ作成が動作することを確認


## バリデーションエラー表示改善（v5.74）

- [x] 入力フィールド近くにポップアップでエラー表示
- [x] 画面上部のキャラクターエラー表示を廃止
- [x] エラーがある入力欄にスクロール


## カテゴリ細分化（v5.75）

- [ ] GitHubにプッシュしてVercel再デプロイ（バージョン表示修正）
- [x] カテゴリを細分化して追加
  - 配信者系: YouTube、TikTok、ツイキャス、ミクチャ、17LIVE、SHOWROOM
  - 俳優・劇場、声優、お笑い、スポーツ
  - 漫画・書籍（予約・発売）
  - ダンサー、DJ、コスプレ、モデル


## 色コントラスト改善（v5.75）

- [x] マイページの色コントラスト改善
  - ユーザー名（ピンク）を明るく
  - @username、フォロワー数を明るく
  - プロフィール説明文を明るく
  - 「別のアカウントでログイン」を明るく
  - 「フォロー済みの方はタップして再確認」を明るく
- [x] 他の画面の色も確認・改善


## 追体験機能設計（v5.75）

- [x] 追体験機能の設計ドキュメント作成
  - 主催者視点のストーリー
  - ファン視点のストーリー
  - 通知機能（お気に入りアーティストのチャレンジ開始時）

- [x] チュートリアルのちかちかアニメーションを削除


## v5.76 タスク

- [x] GitHubにプッシュしてVercel再デプロイ（バージョン表示v5.75に更新）
- [ ] 追体験機能の実装（スライドショー形式）
- [ ] 通知機能の実装（お気に入りアーティストのチャレンジ開始時）


## 追体験機能（v5.76）

- [x] 追体験コンテキスト（ExperienceProvider）の作成
- [x] 追体験オーバーレイコンポーネントの作成
- [x] 主催者視点のスライドショー（8スライド）
- [x] ファン視点のスライドショー（10スライド）
- [x] ホーム画面に追体験バナーを追加
- [ ] 通知機能の実装（お気に入りアーティストのチャレンジ開始時）


## v5.86 タスク

### 編集・削除機能
- [x] イベント詳細画面に主催者用の編集アイコンを追加
- [x] 応援メッセージに編集・取消ボタンを追加（自分の投稿のみ）
- [x] 参加表明削除確認モーダルの実装

### 性別必須化
- [x] 参加表明フォームに性別選択（男性/女性）を追加
- [x] 性別を必須項目に設定
- [x] サーバーAPIにgenderフィールドを追加

### 性別・県の表示
- [x] 貢献度ランキングに性別アイコンと都道府県を表示
- [x] 応援メッセージカードに性別アイコンを表示


## v5.87 タスク

### 既存参加者の性別データ移行
- [ ] マイページから性別を編集できる機能を追加
- [ ] 参加表明の編集APIにgenderフィールドを追加

### 性別別統計表示
- [ ] イベント詳細画面に男女比の円グラフを追加
- [ ] 性別別の参加者数を集計

### 地域別・性別別フィルター機能
- [ ] 応援メッセージを性別でフィルターできる機能を追加
- [ ] 応援メッセージを地域でフィルターできる機能を追加


## v5.87 追体験機能・通知機能

### 追体験機能（ログイン不要デモモード）
- [x] ホーム画面に「追体験してみる」バナーを配置
- [x] ファン視点・主催者視点の選択画面
- [x] 主催者視点のスライドショー（4スライド）
  - チャレンジ作成、参加者増加、地域データ、自信がつく
- [x] ファン視点のスライドショー（10スライド）
  - 通知受信、参加表明、都道府県設定、他のファン発見
  - 気になるファン、影響力のあるファン、安心感
  - ファン同士の交流、友達を誘う、性別データ
- [x] 心理描写の吹き出し表示

### 通知機能（お気に入りアーティストのチャレンジ開始時）
- [ ] お気に入りアーティスト登録機能
- [ ] チャレンジ開始時の通知送信
- [ ] 通知設定画面の更新


## コンポーネントギャラリー（v5.88）

- [x] 管理者ページにコンポーネントギャラリー画面を作成
- [x] TwitterUserCardの各サイズ（sm/md/lg）を表示
- [x] ボタンスタイルの一覧を表示
- [x] カード系コンポーネントの一覧を表示
- [x] 色・フォントの確認セクションを追加


## 数字の不整合問題修正（v5.88）

- [x] 達成状況（currentValue）と実際の参加者数の不整合を調査
- [x] 地域マップの参加者数と達成状況の不整合を調査
- [x] ホーム画面のチャレンジカードの数字を調査
- [x] 管理画面にデータ整合性確認ダッシュボードを作成
- [x] 数字の計算ロジックを修正（createParticipation/deleteParticipationにcurrentValue更新を追加）


## デプロイ反映問題（v5.88）

- [x] ManusのPublishでVercelにも反映されるように設定を確認（docs/DEPLOY.mdに仕様書作成）
- [x] GitHubリポジトリへのプッシュ状況を確認
- [x] 手動でGitHubにプッシュしてVercelデプロイをトリガー（v5.88反映完了）


## 追体験機能改善（v5.90）

### 絵文字をアイコンに置き換え
- [x] 主催者視点：絵文字をアイコン/キャラクター画像に置き換え
- [x] ファン視点：絵文字をアイコン/キャラクター画像に置き換え
- [x] 通知アイコン、地図アイコン、グラフアイコンなどをカスタムスタイルに変更
- [x] キャラクター画像（りんくちゃん、こん太、たぬ姉）を適切な場所に配置


## 追体験機能の大幅充実（v5.91）

### チュートリアル形式への改善
- [x] 主催者視点：チャレンジ作成から達成までの詳細なステップを追加（19スライド）
- [x] ファン視点：参加表明から交流までの詳細なステップを追加（25スライド）
- [x] インタラクティブな要素（タップして次へ進む、アニメーション）を追加
- [x] 各ステップに説明テキストと心理描写を追加
- [x] 実際のアプリ画面を模したUIを表示（13種類の新プレビュータイプ追加）


## ナビゲーションボタン改善（v5.92）

- [x] 「戻る」ボタンをこん太のキャラクター吹き出し形式に変更
- [x] 「次へ」ボタンをたぬ姉のキャラクター吹き出し形式に変更
- [x] キャラクター画像とセリフを組み合わせたボタンデザイン


## ナビゲーション位置変更（v5.93）

- [x] ナビゲーションボタンをコンテンツの下（ScrollView内）に移動
- [x] PC・スマホ両方で使いやすい配置に調整


## ナビゲーション間隔調整（v5.94）

- [x] ナビゲーションボタンとコンテンツの間隔を詰める
- [x] scrollContentのflexGrowを削除してコンテンツに合わせた高さに


## ナビゲーション中央寄せ＆チュートリアル適用（v5.95）

- [x] ナビゲーションボタンを中央に寄せる
- [x] チュートリアルにも同じキャラクターナビゲーションを適用


## チャレンジ作成機能修正（v5.96）

- [x] INSERT INTO challengesのエラーを修正（ticketSaleStartカラムを追加）
- [x] データベーススキーマとの整合性を確認


## エラーハンドリング改善（v5.97）

- [ ] サーバー側のエラーハンドリングを改善（エラーメッセージを分かりやすく）
- [ ] フロントエンドのエラー表示UIを改善（モーダルやトースト）
- [ ] データベースエラー時のユーザーフレンドリーなメッセージを実装


## チャレンジ作成エラー修正（v5.98）

- [x] 本番データベースのchallengesテーブルのカラムを確認
- [x] INSERTクエリに不足しているカラムを追加（AI関連カラム5つ）
- [x] 「まだ決まっていない」オプションを追加（会場、チケット情報）
- [ ] 追体験・チュートリアルに「まだ決まっていない」ケースを追加


## チャレンジ作成エラー修正（v6.03）

### 緊急修正
- [x] 本番DBのスキーマを確認
- [x] createEvent関数を修正（AI関連カラム5つを除外）
- [x] 日程未定オプションをシンプルに実装（UIのみ、DB変更なし）
- [x] テスト・デプロイ・動作確認


## チャレンジ作成エラー修正（v6.04）- 再調査

### 根本原因の特定
- [ ] 本番DBの実際のカラム構造を確認
- [ ] INSERT文を本番DBのカラムに完全に合わせる
- [ ] デプロイ・動作確認


## GPT相談用ドキュメント作成（v6.04）

- [x] 現状の問題を整理（デプロイ問題、チャレンジ作成エラー）
- [x] GPT相談用ドキュメントを作成
- [x] ドキュメントをユーザーに提供


## GPT相談用ドキュメント作成 v3（デプロイ問題の根本解決）

- [x] 現在のコード構造とOpenRouter機能を確認
- [x] デプロイ問題の詳細な分析
- [x] GPT相談用ドキュメントを作成
- [x] ドキュメントをユーザーに提供


## ドキュメント整備（v6.05）

- [ ] project-summary.md（概要ドキュメント）の作成
- [ ] code-reference.md（詳細コードドキュメント）の作成


## ドキュメント作成（v6.04）

- [x] project-summary.md作成（GPT/AI向けプロジェクト概要）
- [x] code-reference.md作成（詳細なコードリファレンス）


## features/events リファクタリング（GPT設計図に基づく）

### Phase 1: ディレクトリ構造の作成
- [ ] features/events/hooks/ ディレクトリ作成
- [ ] features/events/mappers/ ディレクトリ作成
- [ ] features/events/ui/components/ ディレクトリ作成
- [ ] features/events/ui/sections/ ディレクトリ作成
- [ ] features/events/ui/modals/ ディレクトリ作成
- [ ] features/events/screens/ ディレクトリ作成
- [ ] features/events/utils/ ディレクトリ作成

### Phase 2: 型定義・定数・ユーティリティ
- [ ] features/events/mappers/participationVM.ts 作成（Participation, Companion型）
- [ ] features/events/mappers/eventDetailVM.ts 作成（goalTypeConfig含む）
- [ ] features/events/utils/normalizePrefecture.ts 作成
- [ ] features/events/utils/prefectures.ts 作成（regionGroups, prefectures）

### Phase 3: ローカルコンポーネントの移動
- [ ] features/events/ui/components/ProgressGrid.tsx 作成
- [ ] features/events/ui/components/RegionMap.tsx 作成
- [ ] features/events/ui/components/ParticipantsList.tsx 作成
- [ ] features/events/ui/components/ContributionRanking.tsx 作成
- [ ] features/events/ui/components/MessageCard.tsx 作成

### Phase 4: useEventDetailScreenフック
- [ ] features/events/hooks/useEventDetailScreen.ts 作成

### Phase 5: EventDetailScreenとセクション
- [ ] features/events/screens/EventDetailScreen.tsx 作成
- [ ] features/events/ui/sections/HeaderSection.tsx 作成
- [ ] features/events/ui/sections/HostSection.tsx 作成
- [ ] features/events/ui/sections/ProgressSection.tsx 作成
- [ ] features/events/ui/sections/ParticipantsSection.tsx 作成
- [ ] features/events/ui/sections/RankingSection.tsx 作成
- [ ] features/events/ui/sections/MessagesSection.tsx 作成
- [ ] features/events/ui/sections/ShareSection.tsx 作成

### Phase 6: app/event/[id].tsxの薄化
- [ ] app/event/[id].tsx を3行に薄化
- [ ] コンパイルエラーの修正
- [ ] 動作確認


## バグ修正（v6.05）
- [x] チャレンジ作成エラー修正: Unknown column 'slug' in 'field list'（server/db.tsのcreateEvent関数からslugカラムを削除）

## 緊急バグ修正（v6.22）
- [x] 真っ黒画面問題を調査・修正
- [x] チャレンジ作成機能の動作確認


## コンポーネントリファクタリング（v6.14+）

### Phase 1: コードベース分析
- [x] 重複コードの特定（都道府県リスト、4ファイル、regionGroups 5ファイル、goalTypeConfig 4ファイル）
- [x] 大きなコンポーネントの特定（event/[id].tsx 2953行、experience-overlay 2017行、index.tsx 1358行）
- [x] 共通パターンの抽出候補を特定

### Phase 2: 共通定数・型の抽出
- [x] constants/prefectures.ts 作成（都道府県リスト、地域グループ、ユーティリティ関数）
- [x] constants/goal-types.ts 作成（目標タイプ設定、ユーティリティ関数）
- [x] types/participation.ts 作成（参加者型定義、性別型）

### Phase 3: イベント詳細画面のコンポーネント分割
- [x] features/events/components/ProgressGrid.tsx 作成（進捗グリッド）
- [x] features/events/components/RegionMap.tsx 作成（地域別マップ）
- [x] features/events/components/ParticipantsList.tsx 作成（参加者リスト）
- [x] features/events/components/ContributionRanking.tsx 作成（貢献度ランキング）
- [x] features/events/components/MessageCard.tsx 作成（応援メッセージカード）
- [x] features/events/index.ts 作成（モジュールエクスポート）
- [ ] app/event/[id].tsx を新コンポーネントで置き換え
- [ ] チャレンジ作成画面の分割
- [ ] ホーム画面の分割

### Phase 4: 重複コードの削除
- [x] goalTypeConfigの共通化（colorful-challenge-card, memoized-challenge-card, index.tsx, event/[id].tsx）
- [x] regionGroups/prefecturesの共通化（event/[id].tsx）
- [x] 各ファイルのローカル定義にコメント追加（用途の明確化）
- [x] イベントタイプバッジの共通化（constants/event-types.ts）
- [x] constants/index.ts 作成（共通定数の一括エクスポート）


## コンポーネント置き換え実装（v6.16+）

### event/[id].tsxの置き換え（2,925行 → 2,484行、-441行）
- [x] RegionMapコンポーネントの置き換え
- [x] ParticipantsListコンポーネントの置き換え
- [x] ContributionRankingコンポーネントの置き換え
- [x] MessageCardコンポーネントの置き換え

### index.tsxの置き換え
- [x] FeaturedChallengeコンポーネントの分離（features/home/components/）
- [x] ChallengeCardコンポーネントの分離（features/home/components/）
- [x] types/challenge.ts 作成（Challenge型定義、eventTypeBadge）
- [ ] メインファイルでの置き換え（今後）

### experience-overlay.tsxの分割
- [x] 構造分析完了
  - PreviewContent: 540行（23種類のswitch case）
  - ExperienceOverlay: 180行
  - StyleSheet: 1,280行（共有）
- [x] 分割不要と判断（スタイル依存関係が複雑なため現状維持）


## コンポーネント置き換え実装 Phase 2（v6.17+）

### index.tsxの完全置き換え（1,350行 → 1,059行、-291行）
- [x] FeaturedChallengeをfeatures/homeからインポートして置き換え
- [x] ChallengeCardをfeatures/homeからインポートして置き換え
- [x] ローカル定義の削除（FeaturedChallenge, ChallengeCard, Challenge型, eventTypeBadge, regionGroups）

### 残りのローカルコンポーネントの分離（index.tsx: 1,059行 → 671行、-388行）
- [x] EngagementSectionの分離（features/home/components/）
- [x] CatchCopySectionの分離（features/home/components/）
- [x] FeatureListSectionの分離（features/home/components/）
- [x] ExperienceBannerの分離（features/home/components/）

### カスタムフックの抽出
- [x] ホーム画面のビジネスロジックの抽出は見送り（複雑な依存関係のためリスクが高い）


## リファクタリング完了サマリー

### index.tsx
- 元: 1,350行 → 現在: 671行（**-679行、50%削減**）
- 分離コンポーネント: FeaturedChallenge, ChallengeCard, EngagementSection, CatchCopySection, FeatureListSection, ExperienceBanner

### event/[id].tsx
- 元: 2,953行 → 現在: 2,484行（**-469行**）
- 分離コンポーネント: RegionMap, ParticipantsList, ContributionRanking, MessageCard

### 共通定数・型定義
- constants/prefectures.ts: 都道府県リスト、地域グループ
- constants/goal-types.ts: 目標タイプ設定
- constants/event-types.ts: イベントタイプバッジ
- types/challenge.ts: Challenge型定義
- types/participation.ts: 参加者型定義

### 合計削減行数: 約1,150行


## mypage.tsx & create.tsx の分割（v6.18+）

### mypage.tsx の分割（1,104行 → 365行、**-739行、67%削減**）
- [x] 構造分析とコンポーネント特定
- [x] LoginScreenコンポーネントの分離（features/mypage/components/）
- [x] ProfileCardコンポーネントの分離（features/mypage/components/）
- [x] SettingsLinkItemコンポーネントの分離（features/mypage/components/）
- [x] メインファイルでの置き換え

### create.tsx の分割（994行）
- [ ] 構造分析とコンポーネント特定
- [ ] ローカルコンポーネントの分離
- [ ] メインファイルでの置き換え


## create.tsx 分割（GPT推奨構造）（v6.19+）

### ディレクトリ構造
```
features/create/
├── hooks/
│   └── useCreateChallengeForm.ts  # state/handler/validation
├── ui/
│   ├── components/
│   │   ├── GoalTypeSelector.tsx
│   │   ├── EventTypeSelector.tsx
│   │   ├── PrefectureSelector.tsx
│   │   ├── TicketInfoSection.tsx
│   │   ├── TemplateSaveSection.tsx
│   │   └── index.ts
│   └── sections/
│       └── CreateFormCard.tsx
├── types.ts
└── index.ts
```

### タスク
- [ ] features/create/types.ts 作成（CreateChallengeFormState型）
- [ ] features/create/hooks/useCreateChallengeForm.ts 作成
- [ ] features/create/ui/components/GoalTypeSelector.tsx 作成
- [ ] features/create/ui/components/EventTypeSelector.tsx 作成
- [ ] features/create/ui/components/PrefectureSelector.tsx 作成
- [ ] features/create/ui/components/TicketInfoSection.tsx 作成
- [ ] features/create/ui/components/TemplateSaveSection.tsx 作成
- [ ] app/(tabs)/create.tsx を薄型化


## コードリファクタリング（v4.5）

### create.tsx 分割（GPT推奨構造）
- [x] features/create/ディレクトリ構造の作成
- [x] types.ts（フォーム状態の型定義）
- [x] hooks/useCreateChallengeForm.ts（フォームロジックのフック）
- [x] ui/components/EventTypeSelector.tsx
- [x] ui/components/GoalTypeSelector.tsx
- [x] ui/components/CategorySelector.tsx
- [x] ui/components/TicketInfoSection.tsx
- [x] ui/components/TemplateSaveSection.tsx
- [x] create.tsxの薄型化（971行 → 636行、約35%削減）
- [x] TypeScriptエラー修正（eventTypes/goalTypes → eventTypeOptions/goalTypeOptions）


### mypage.tsx 分割（GPT推奨構造）
- [x] mypage.tsxの現状分析
- [x] features/mypage/ディレクトリ構造の整理
- [x] UIコンポーネントの分離（BadgeSection, ParticipationSection, HostedChallengeSection）
- [x] mypage.tsxの薄型化（365行 → 238行、約35%削減）
- [x] テスト実行と動作確認


### index.tsx（ホーム画面）分割（GPT推奨構造）
- [x] index.tsxの現状分析
- [x] features/home/ディレクトリ構造の作成
- [x] UIコンポーネントの分離（RecommendedHostsSection, FilterButton, SectionHeader, SearchBar, CategoryFilter, HomeEmptyState）
- [x] index.tsxの薄型化（671行 → 449行、約33%削減）
- [x] テスト実行と動作確認


## 視認性問題の修正（v4.6）

### イベント詳細画面の視認性改善
- [x] ContributionRanking.tsx - ユーザー名色を修正（#DD6500 → #FBBF24 アンバー）
- [x] ContributionRanking.tsx - フォロワー数色を修正（#9CA3AF → #D1D5DB 明るいグレー）
- [x] MessageCard.tsx - ユーザー名色を修正（#DD6500 → #FBBF24 アンバー）
- [x] MessageCard.tsx - フォロワー数色を修正（#EC4899 → #F472B6 明るいピンク）
- [x] テスト実行と動作確認


### GPT提案に基づく追加改善
- [ ] ContributionRanking.tsx - フォロワー数フォントサイズを11px→12pxに修正
- [ ] 直書き色の全体検索（#DD6500, #EC4899, #9CA3AF）
- [ ] events専用テーマトークンの作成（features/events/ui/theme/tokens.ts）
- [ ] 他ファイルの直書き色をトークンに置き換え


### eventsテーマトークン実装（再発防止）
- [x] features/events/ui/theme/tokens.ts を作成
- [x] ContributionRanking.tsx を直書き→トークンに置換
- [x] MessageCard.tsx を直書き→トークンに置換
- [x] テスト実行と動作確認


## GPT置換表に基づくトークン化（v4.7）

### 今日：ChallengeCard.tsx視認性改善
- [x] 日付アイコン色: #DD6500 → #FBBF24
- [x] 日付テキスト: #DD6500, 11px → #FBBF24, 12px

### 今週：events内21箇所のトークン化
- [x] tokens.tsにトークンを追加（accent, fallback, iconMuted, hint, danger）
- [x] ContributionRanking.tsx - 残り5箇所をトークン化
- [x] MessageCard.tsx - 残り15箇所をトークン化
- [x] ParticipantsList.tsx - 6箇所をトークン化
- [x] ProgressGrid.tsx - 3箇所をトークン化
- [x] RegionMap.tsx - 2箇所をトークン化

**結果: events内の直書き色（#DD6500, #EC4899, #9CA3AF）は0箇所になりました！**


## チュートリアル/追体験機能の強化（将来計画）

### 訴求ポイントの追加
- [ ] 「まだ決まってない」選択肢を追加（イベント未定でも事前に動員予測ができる）
- [ ] ライブ動員予測の訴求 - 「みんながどれぐらいライブに来てくれるか事前にわかる」
- [ ] 本・グッズ販売予測の訴求 - 「本を出したときにどれぐらい売れるか事前にわかる」
- [ ] チュートリアル画面でこれらのユースケースを紹介
- [ ] 追体験機能（デモモード）でこれらのシナリオを体験できるようにする

---

## リファクタリング継続計画（v4.8以降）

### 他のfeaturesのトークン化（段階的）
- [ ] features/home/ のトークン化
- [ ] features/create/ のトークン化
- [ ] features/mypage/ のトークン化

### ライト/ダークテーマ対応
- [ ] tokens.tsをuseColors()に連携
- [ ] テーマ切り替え時に色が自動で変わるようにする

### 共通フォーム部品の抽出
- [ ] RadioButton, Checkbox, NumberStepperなどを共通コンポーネント化


## features/home トークン化（v4.8）

### tokens.ts作成
- [ ] features/home/ui/theme/tokens.ts を作成

### 16箇所の置換
- [ ] FeaturedChallenge.tsx - 3箇所
- [ ] ChallengeCard.tsx - 3箇所
- [ ] EngagementSection.tsx - 1箇所
- [ ] CatchCopySection.tsx - 2箇所
- [ ] FeatureListSection.tsx - 2箇所
- [ ] ExperienceBanner.tsx - 1箇所
- [ ] FilterButton.tsx - 1箇所
- [ ] SectionHeader.tsx - 2箇所
- [ ] SearchBar.tsx - 1箇所
- [ ] テスト実行と動作確認


## リファクタリング（v4.5）

### コンポーネント分割
- [x] create.tsx分割（971行→636行、約35%削減）
- [x] mypage.tsx分割（365行→238行、約35%削減）
- [x] index.tsx分割（671行→449行、約33%削減）

### 視認性改善・トークン化
- [x] features/events のトークン化（21箇所→0箇所）
- [x] features/home のトークン化（47箇所→0箇所）
- [ ] features/create のトークン化（13箇所/5ファイル）
- [ ] features/mypage のトークン化（12箇所/6ファイル）


## レスポンシブレイアウト改善（v4.6）

### FlatList列数自動計算
- [x] getCols(width) 関数の実装（<480:2列, 480-768:2列, 768-1024:3列, >=1024:4列）
- [x] getCardWidth() 関数の実装（gap考慮のピクセル計算）
- [x] useGridLayout() フックの実装

### チャレンジカードのレスポンシブ対応
- [x] ChallengeCard.tsx に itemWidth props を追加
- [x] パーセンテージ幅からピクセル幅に変更

### カテゴリフィルターの大画面対応
- [x] デスクトップ: flexWrap で一覧表示
- [x] スマホ/タブレット: 横スクロール維持

### ホーム画面の更新
- [x] useGridLayout() を使用したFlatList更新
- [x] columnWrapperStyle の gap 調整


## features/create トークン化（v4.7）

### 直書き色の調査結果（32箇所/5ファイル）
- [x] CategorySelector.tsx: 5箇所（#2D3139, #9CA3AF, #EC4899）
- [x] EventTypeSelector.tsx: 1箇所（#2D3139）
- [x] GoalTypeSelector.tsx: 4箇所（#EC4899, #2D3139, #9CA3AF）
- [x] TemplateSaveSection.tsx: 8箇所（#1A1D21, #2D3139, #8B5CF6, #6B7280, #9CA3AF, #22C55E）
- [x] TicketInfoSection.tsx: 14箇所（#2D3139, #EC4899, #4B5563, #9CA3AF, #1A1D21）

### トークン定義
- [x] createUI: UI要素色（inputBg, inputBorder, placeholder, activeAccent, checkboxBorder, checkboxActive）
- [x] createText: テキスト色（muted, accent, success）


## features/mypage トークン化（v4.7）

### 直書き色の調査結果（58箇所/6ファイル）
- [x] LoginScreen.tsx: 20箇所（グラデーション、アクセント色、ボーダー）
- [x] ProfileCard.tsx: 16箇所（背景、グラデーション、統計数値、ボタン）
- [x] SettingsLinkItem.tsx: 4箇所（背景、ボーダー、テキスト）
- [x] BadgeSection.tsx: 6箇所（背景、ボーダー、テキスト）
- [x] ParticipationSection.tsx: 5箇所（背景、ボーダー、テキスト）
- [x] HostedChallengeSection.tsx: 7箇所（背景、ボーダー、主催バッジ）

### トークン定義
- [x] mypageUI: UI要素色（cardBg, cardBorder, buttonBg）
- [x] mypageText: テキスト色（muted, accent, stats）
- [x] mypageGradient: グラデーション色
