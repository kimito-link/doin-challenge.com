# mdファイル監査結果

**監査日時**: 2026-01-29  
**目的**: すべてのmdファイルのチェックリストと実装の整合性を確認

---

## 📊 監査結果サマリー

| mdファイル | チェック項目数 | 実装済み | 未実装 | デプロイ待ち | ステータス |
|-----------|--------------|---------|--------|------------|----------|
| visibility-issues.md | 4 | 4 | 0 | 4 | ✅ コード完成、デプロイ待ち |
| gate1.md | 4 | 3 | 1 | 0 | ⚠️ Sentryのみ未実装 |
| critical-features-checklist.md | 50+ | - | - | - | 📋 テストチェックリスト（実装対象外） |
| project-ng-list.md | - | - | - | - | 📚 ガイドライン（実装対象外） |
| next-steps-proposal.md | 3 | 0 | 3 | 0 | ⬜ 未着手 |

---

## 詳細調査結果

### 1. visibility-issues.md ✅

**ステータス**: コード完成、デプロイ待ち

#### チェックリスト
- [x] ContributionRanking.tsx のユーザー名色を修正（#DD6500 → #FBBF24）
- [x] ContributionRanking.tsx のフォロワー数色を修正（#9CA3AF → #D1D5DB）
- [x] MessageCard.tsx のユーザー名色を修正（#DD6500 → #FBBF24）
- [x] MessageCard.tsx のフォロワー数色を修正（#EC4899 → #F472B6）

#### 実装状況
- ✅ トークン化完了（`features/events/ui/theme/tokens.ts`）
- ✅ コンポーネント修正完了（`eventText.username`、`eventText.follower`使用）
- ⏳ **本番環境にデプロイされていない**（v6.147/v6.53 → v6.160へのデプロイ待ち）

---

### 2. gate1.md ⚠️

**ステータス**: 75%完了（Sentryのみ未実装）

#### チェックリスト
- [x] diff-checkをGitHub Actionsに組み込み
- [x] deploy後に `/api/health` を叩いて `commitSha === GITHUB_SHA` を検証
- [x] UptimeRobotで `/api/health` を監視
- [ ] Sentry導入（通知は最小3種類だけ）

#### 実装状況
- ✅ `scripts/diff-check.sh` 実装済み
- ✅ GitHub Actions ワークフロー実装済み（`.github/workflows/deploy-vercel.yml`）
- ✅ UptimeRobot設定完了（今日設定）
- ❌ Sentry未実装

---

### 3. critical-features-checklist.md 📋

**ステータス**: テストチェックリスト（実装対象外）

#### 用途
- デプロイ前の手動テストチェックリスト
- 既存機能が壊れていないことを確認
- 実装タスクではなく、テスト実施記録

#### 確認された問題（本番環境）
- ❌ ログインエラー（"Invalid or expired state parameter"）
- ❌ 統計ダッシュボードエラー
- ❌ サムネイル画像が表示されない
- ❌ オリジナルキャラが表示されない
- ❌ 「たぬ姉」→「たぬね」表記ミス
- ❌ 地図がレスポンシブになっていない
- ❌ チャレンジ作成のプロフィール文章が表示されない

---

### 4. project-ng-list.md 📚

**ステータス**: ガイドライン（実装対象外）

#### 用途
- 触ってはいけないファイルのリスト
- OAuth、データベーススキーマ、サーバーコア機能など
- 開発時の注意事項

#### 準拠状況
- ✅ 現在の実装は全てNG集に準拠

---

### 5. next-steps-proposal.md ⬜

**ステータス**: 未着手

#### 提案内容
- 選択肢1: ChallengeCard.tsxコンポーネントのトークン化
- 選択肢2: ChallengeCard.tsxの視認性改善
- 選択肢3: アプリ全体のテキストトークン作成

#### 実装状況
- ❌ 全て未実装

---

## 🎯 優先度順の対応リスト

### 🔴 最優先（本番環境の問題）

1. **ログインエラー修正**
   - PKCEデータの有効期限を10分→30分に延長
   - エラーメッセージの改善

2. **統計ダッシュボード修正**
   - ログイン状態チェックの追加
   - 空データ時の表示改善

3. **サムネイル画像表示修正**
   - チャレンジデータ構造の確認
   - `thumbnailUrl`フィールドの追加または修正

4. **その他のUI問題**
   - オリジナルキャラ表示
   - 「たぬね」→「たぬ姉」修正
   - 地図のレスポンシブ対応
   - プロフィール文章表示

### 🟡 中優先（デプロイ待ち）

5. **視認性修正のデプロイ**
   - 現在の開発環境（v6.160）を本番環境にデプロイ

### 🟢 低優先（追加機能）

6. **Sentry導入**
   - エラートラッキング
   - 通知設定（3種類のみ）

7. **next-steps-proposal.mdの実装**
   - ChallengeCard.tsxの改善

---

## 🔧 md準拠チェックスクリプトの提案

### 目的
- チェックリストの項目が実際のコードに反映されているか自動検証
- デプロイ前に未実装の修正を検出

### 実装方法
```bash
scripts/check-md-compliance.sh
```

### チェック項目
1. visibility-issues.mdの色コードチェック
2. gate1.mdの実装状況チェック
3. project-ng-listの違反チェック

---

## 次のステップ

1. ✅ md監査完了
2. ⬜ 本番環境の問題を修正
3. ⬜ すべての修正をデプロイ
4. ⬜ md準拠チェックスクリプトを作成
5. ⬜ GitHub Actionsワークフローに統合
