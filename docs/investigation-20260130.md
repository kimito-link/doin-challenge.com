# 本番環境調査結果 - 2026年1月30日

## 調査目的

ユーザーからの報告：

> 視認性が悪かったり
> クッションページを挟んでなかったりおかしな点たくさんあります。
> ほんとにmdの内容を全部実装してますか？

## 調査結果

### 1. クッションページ（カスタムログイン画面）の実装状況

**結論**: ✅ **実装されている**

**確認内容**:

- マイページに「Xでログインする」ボタンが表示されている
- ボタンをクリックすると、**カスタムログイン画面（モーダル）**が表示される
- モーダルには以下の要素が含まれている：
  - りんくのキャラクターアイコン（3つ並んでいる）
  - 「みんな、ちょっと聞いて！」というタイトル
  - 「あなたの『推し』が、大きなステージに立つ瞬間を一緒に作りたいんだ」という説明文
  - 「その夢を応援しに行こう！」という呼びかけ
  - 「Xでログインする」ボタン（青色、プライマリ）
  - 「あなたの『推し』が、大きなステージに立つ瞬間を一緒に作りたいんだ」という説明文（下部）

**実装ファイル**:

- `/home/ubuntu/birthday-celebration/components/organisms/login-confirm-modal.tsx`
- `/home/ubuntu/birthday-celebration/components/organisms/link-speech.tsx`
- `/home/ubuntu/birthday-celebration/app/(tabs)/mypage.tsx`（使用箇所）

**カスタムログイン画面の内容**:

- タイトル: 「Xでログインしますか？」
- 説明1: 「このあとXの公式画面に移動します。」
- 説明2: 「戻ってきたらログイン完了です。」
- りんくの吹き出し: 「ログインすると、参加履歴やお気に入りが使えるよ！」
- ボタン: 「Xでログイン」（青色、プライマリ）
- ボタン: 「やめておく」（グレー、セカンダリ）

**問題点**:

- ❌ **critical-features-checklist.mdの記載と異なる**
  - チェックリストには「ホーム画面で『Xでログイン』ボタンが表示される」と記載されているが、実際には**マイページ**に表示されている
  - チェックリストには「ボタンをクリックすると**オリジナルのログイン画面（カスタム認証ボタン）**が表示される」と記載されているが、実際には**モーダル**が表示される

- ❌ **ホーム画面にログインボタンがない**
  - ホーム画面には「主催者の追体験」「ファンの追体験」ボタンがあるが、ログインボタンがない
  - ユーザーがログインしたい場合、マイページに移動する必要がある

### 2. 視認性の問題

**調査中**: 次のフェーズで確認

### 3. サムネイル画像の表示

**確認内容**:

- ホーム画面のチャレンジカード（1番、2番、3番）にサムネイル画像が表示されている
- 画像は正しく表示されている

**問題点**:

- ❌ **4番以降のチャレンジカードにサムネイル画像が表示されていない**
  - 4番: 「君斗りんくのお笑いライブ」
  - 5番: 「あ」
  - 6番: 「charen」
  - 7番: 「テストチャレンジ」
  - 8番: 「あああああ」
  - 9番: 「げｇｓ」

### 4. バージョン表示

**確認内容**:

- オンボーディング画面: v6.166（右上）
- ホーム画面: v6.166（ヘッダー）

**問題点**:

- ✅ **バージョン表示は統一されている**

### 5. マイページのキャラクター表示

**確認内容**:

- マイページにりんくのキャラクターアイコンが3つ並んで表示されている

**問題点**:

- ✅ **オリジナルキャラが表示されている**

## 未実装項目の洗い出し

### 最優先: ホーム画面にログインボタンを追加

- [ ] ホーム画面に「Xでログイン」ボタンを追加
- [ ] ボタンをクリックすると、カスタムログイン画面（モーダル）が表示される

### サムネイル画像の表示

- [ ] 4番以降のチャレンジカードにサムネイル画像が表示されない問題を調査
- [ ] サムネイル取得・表示ロジックを修正

### 視認性の問題

- [ ] ホーム画面のテキストとボタンのコントラスト比を確認（WCAG 2.1 AA基準）
- [ ] イベント詳細画面以外の画面でも視認性の問題がないか確認
- [ ] 実機で視認性を確認

### UptimeRobotの監視設定

- [ ] UptimeRobotで `/api/health` を監視（5分間隔）
- [ ] 監視設定の手順をdocs/uptime-robot-setup.mdに記載

### Sentryの導入

- [ ] Sentry導入（通知は最小3種類だけ）
  - ログイン失敗の急増（OAuth callback error）
  - 5xxの急増
  - "unknown version"検知（healthがunknownを返したら例外を投げる）

## 次のアクション

1. **ホーム画面にログインボタンを追加**（最優先）
2. **サムネイル画像の表示問題を修正**
3. **視認性の問題を確認・修正**
4. **UptimeRobotの監視設定**
5. **Sentryの導入**
