# 命令の「4点セット」テンプレート

**最終更新**: 2026-02-02  
**対象者**: 開発者全員

このドキュメントは、新しい機能を実装する前に、AIアシスタントに命令を渡す際のテンプレートです。曖昧さを排除し、Done条件を明確化します。

---

## Contract: [機能名]

### 1. 目的（Why）

<!-- なぜこの機能を実装するのか？ -->
<!-- ビジネス価値、ユーザー価値、技術的価値を明確に -->

例:
- ユーザーがより簡単に操作できるようにするため
- パフォーマンスを改善するため
- セキュリティを強化するため

### 2. やること（What）

<!-- 何を実装するのか？ -->
<!-- 具体的なタスクをリストアップ -->

- [ ] タスク1: データベーススキーマの設計
- [ ] タスク2: APIエンドポイントの実装
- [ ] タスク3: フロントエンドコンポーネントの実装
- [ ] タスク4: テストの作成

### 3. やってはいけないこと（NG）

<!-- 絶対に変更してはいけないファイル、機能 -->
<!-- 影響範囲を明確に -->

- 認証関連ファイルを変更しない（`server/_core/oauth.ts`, `app/oauth/`など）
- Deploy関連ファイルを変更しない（`vercel.json`, `.github/workflows/`など）
- 既存の機能を壊さない
- データベースの既存テーブル構造を変更しない（新規テーブルのみ追加）

### 4. Done条件（チェック可能）

<!-- どうなったら完了とみなすか？ -->
<!-- 測定可能な条件を記載 -->

- [ ] diff-check.shを実行し、警告がない（または警告がある場合は追加テストを実施）
- [ ] ローカル環境でテストし、動作を確認（http://localhost:8081）
- [ ] 影響範囲を把握し、関連する機能が壊れていないことを確認
- [ ] PRを作成し、Gate 1チェックリストを全てチェック
- [ ] バージョン番号を更新（`shared/version.ts`）
- [ ] コミットメッセージが`v6.XXX:`形式で記載されている

---

## 使用例

### 例1: 新機能追加

```markdown
## Contract: チャレンジ検索機能

### 1. 目的（Why）
ユーザーがチャレンジを簡単に見つけられるようにするため

### 2. やること（What）
- [ ] 検索APIエンドポイントの実装
- [ ] 検索UIコンポーネントの実装
- [ ] 検索結果の表示コンポーネントの実装

### 3. やってはいけないこと（NG）
- 既存のチャレンジ一覧機能を変更しない
- 認証機能を変更しない

### 4. Done条件（チェック可能）
- [ ] 検索キーワードでチャレンジが検索できる
- [ ] 検索結果が正しく表示される
- [ ] 既存のチャレンジ一覧機能が正常に動作する
```

### 例2: バグ修正

```markdown
## Contract: ログイン時のエラーハンドリング修正

### 1. 目的（Why）
ログイン失敗時に適切なエラーメッセージを表示するため

### 2. やること（What）
- [ ] エラーハンドリングロジックの修正
- [ ] エラーメッセージの表示コンポーネントの実装

### 3. やってはいけないこと（NG）
- 認証フロー自体を変更しない
- OAuthコールバック処理を変更しない

### 4. Done条件（チェック可能）
- [ ] ログイン失敗時に適切なエラーメッセージが表示される
- [ ] ログイン成功時の動作が正常である
```

---

## 関連ドキュメント

- [docs/GATE1_WORKFLOW.md](./GATE1_WORKFLOW.md) - Gate 1 + こまめなバージョン管理の統合ワークフロー
- [docs/DATA_DESIGN_PRINCIPLES.md](./DATA_DESIGN_PRINCIPLES.md) - データ構造から考える開発原則
- [docs/GIT_DEVELOPMENT_WORKFLOW.md](./GIT_DEVELOPMENT_WORKFLOW.md) - Git開発の基本作法

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|-----------|---------|
| 2026-02-02 | v1.0 | 初版作成 - 命令の「4点セット」テンプレートを確立 |
