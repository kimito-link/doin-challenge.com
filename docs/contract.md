# 開発契約テンプレート

このファイルは、AIと人間の協働開発において、「命令の見落とし」を防ぐための契約テンプレートです。

## 命令の「4点セット」テンプレート

新しい機能や変更を実装する際は、以下の4点を明確にしてください：

### 1. 目的（Why）

**なぜこの変更が必要なのか？**

- 
- 

### 2. やること（What）

**何を実装するのか？**

- 
- 
- 

### 3. やってはいけないこと（NG）

**何をしてはいけないのか？**

- 
- 

### 4. Done条件（チェック可能）

**どうなったら完了なのか？**

- [ ] 
- [ ] 
- [ ] 

---

## Gate 1: 必須契約

以下の変更を行う場合、**必ず**Gate 1のチェックリストを完了してください：

1. **OAuth / 認証**: ログイン、セッション、コールバック、トークン管理
2. **Deploy / CI**: デプロイ設定、CI/CD、ビルドプロセス
3. **Env**: 環境変数、シークレット、設定
4. **DB**: スキーマ、マイグレーション、クエリ
5. **Health**: ヘルスチェック、起動プロセス
6. **Routing / Redirect / Proxy**: ルーティング、リダイレクト、プロキシ

### Gate 1チェックリスト

- [ ] diff-check.shを実行し、警告を確認した
- [ ] ローカル環境で動作確認した
- [ ] 既存機能が壊れていないことを確認した
- [ ] Deploy後、本番環境で動作確認する予定がある
- [ ] ロールバック手順を確認した

---

## 例: 性別統計表示機能の実装

### 1. 目的（Why）

- ユーザーから「チャレンジ参加者の男女の区別がつかない」という要望が何度もあった
- ホーム画面のチャレンジカードで、参加者の性別統計を表示したい

### 2. やること（What）

- `GenderIndicator`コンポーネントを作成（個別の性別アイコン）
- `GenderStats`コンポーネントを作成（性別統計の表示）
- データベースクエリで性別統計を集計するAPIを実装
- ホーム画面のチャレンジカードに性別統計を表示

### 3. やってはいけないこと（NG）

- サムネイル画像の表示を壊さない
- ログイン機能を壊さない
- 既存のチャレンジカードのレイアウトを大きく変更しない

### 4. Done条件（チェック可能）

- [x] `GenderIndicator`コンポーネントが作成され、正しく動作する
- [x] `GenderStats`コンポーネントが作成され、正しく動作する
- [x] APIが性別統計を返す
- [x] ホーム画面のチャレンジカードに性別統計が表示される
- [ ] サムネイル画像が正しく表示される
- [ ] ログイン機能が正しく動作する

---

## 運用ルール

1. **命令は「契約」にする**: 自然文を機械が読める契約に変換する
2. **Done条件を先に出す**: 「何ができたら完了か」を最初に決める
3. **AIに「勝手にやらせない」**: diff-check、PRテンプレ、Gate制を先に作る
4. **成功メッセージを信用しない**: GitHub main / Vercel / health の三点照合が正解
