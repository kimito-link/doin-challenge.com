# GitHub ワークフロー品質管理ガイド（汎用版）

**どんなプロジェクトでも適用できる、品質を上げるための実装ガイド**

このガイドは、Phase 2実装ガイドで培ったノウハウを汎用化したものです。PR（Pull Request）ベースの開発で、品質を担保しながら迅速に開発を進めるための原則とテンプレートを提供します。

---

## 目次

1. [基本原則](#基本原則)
2. [PRの構造](#prの構造)
3. [実装ガイドテンプレート](#実装ガイドテンプレート)
4. [NG集テンプレート](#ng集テンプレート)
5. [レビューチェックリストテンプレート](#レビューチェックリストテンプレート)
6. [使い方](#使い方)

---

## 基本原則

### 1. 段階的な実装（PR分割）

**大きな機能を小さなPRに分割する**ことで、レビューしやすく、デグレードを防ぎます。

**原則**:
- 1PR = 1つの明確な目的
- PRは独立してテスト可能
- PRは独立してロールバック可能

**例**:
```
大きな機能: ユーザー認証システム
├── PR-1: ログインボタンとモーダル（UIのみ、API呼び出しなし）
├── PR-2: API呼び出し追加（ログイン処理）
├── PR-3: ログイン成功時の画面遷移
├── PR-4: エラーハンドリング
└── PR-5: 全体統合とE2Eテスト
```

### 2. NG集の作成

**やってはいけないこと**を明確にすることで、事故を防ぎます。

**NG集に含めるべき項目**:
- 触ってはいけないファイル
- 使ってはいけないライブラリ/関数
- 禁止されている実装パターン
- 過去に問題を起こした実装

### 3. レビューチェックリスト

**レビュー基準を明文化**することで、品質を担保します。

**チェックリストに含めるべき項目**:
- NG集に違反していないか
- テストが通るか
- 既存機能が壊れていないか
- コードスタイルが統一されているか

### 4. 実装前の設計確認

**実装前にGPTなどのAIに相談**することで、設計ミスを防ぎます。

**相談すべき内容**:
- PR分割の妥当性
- 実装方針の選択肢
- テスト戦略
- デグレードリスク

---

## PRの構造

### PR命名規則

```
PR-{番号}: {目的の簡潔な説明}
```

**例**:
- `PR-1: ログインボタンとモーダルUI`
- `PR-2: ログインAPI呼び出し追加`
- `PR-3: ログイン成功時の画面遷移`

### PRの説明テンプレート

```markdown
## 目的

このPRで何を実現するか（1文で）

## 実装内容

- [ ] タスク1
- [ ] タスク2
- [ ] タスク3

## 影響範囲

- 変更ファイル: `file1.ts`, `file2.tsx`
- 影響する機能: 機能A, 機能B

## テスト

- [ ] ユニットテスト追加
- [ ] 既存テスト全パス
- [ ] 手動テスト完了

## レビューポイント

- NG集に違反していないか確認
- 既存機能が壊れていないか確認

## スクリーンショット（必要に応じて）

（画像を添付）
```

---

## 実装ガイドテンプレート

プロジェクトの実装ガイドを作成する際のテンプレートです。

```markdown
# {プロジェクト名} 実装ガイド

## 概要

このプロジェクトの目的と、実装ガイドの役割を説明します。

## アーキテクチャ

### 全体構成

```
project/
├── src/
│   ├── components/  # UIコンポーネント
│   ├── hooks/       # カスタムフック
│   ├── lib/         # ユーティリティ
│   └── types/       # 型定義
├── tests/           # テスト
└── docs/            # ドキュメント
```

### 技術スタック

- フレームワーク: {React/Vue/Next.js等}
- 言語: {TypeScript/JavaScript等}
- テスト: {Jest/Vitest等}
- スタイル: {Tailwind/CSS Modules等}

## 実装原則

### 1. コンポーネントの独立性

各コンポーネントは独立してテスト可能であること。

### 2. 型安全性

TypeScriptの型チェックを最大限活用すること。

### 3. テストカバレッジ

重要なロジックには必ずユニットテストを書くこと。

## PR分割戦略

### 大きな機能の分割例

**機能: {機能名}**

```
├── PR-1: {目的1}
│   ├── 実装内容: {詳細}
│   └── テスト: {テスト内容}
├── PR-2: {目的2}
│   ├── 実装内容: {詳細}
│   └── テスト: {テスト内容}
└── PR-3: {目的3}
    ├── 実装内容: {詳細}
    └── テスト: {テスト内容}
```

## NG集

詳細は `docs/ng-list.md` を参照。

## レビューチェックリスト

詳細は `docs/review-checklist.md` を参照。

## トラブルシューティング

### よくある問題と解決策

**問題1: {問題の説明}**
- 原因: {原因}
- 解決策: {解決策}

**問題2: {問題の説明}**
- 原因: {原因}
- 解決策: {解決策}
```

---

## NG集テンプレート

プロジェクトのNG集を作成する際のテンプレートです。

```markdown
# {プロジェクト名} NG集

**このファイルは、やってはいけないことをまとめたものです。**

PRレビュー時に必ずチェックしてください。

---

## 触ってはいけないファイル

以下のファイルは、特別な理由がない限り変更してはいけません。

### 1. {ファイル名またはディレクトリ}

**理由**: {理由}

**例外**: {例外がある場合}

### 2. {ファイル名またはディレクトリ}

**理由**: {理由}

**例外**: {例外がある場合}

---

## 使ってはいけないライブラリ/関数

### 1. {ライブラリ名または関数名}

**理由**: {理由}

**代替案**: {代替案}

### 2. {ライブラリ名または関数名}

**理由**: {理由}

**代替案**: {代替案}

---

## 禁止されている実装パターン

### 1. {パターン名}

**NG例**:
```typescript
// NG: {理由}
const badExample = () => {
  // 悪い実装
};
```

**OK例**:
```typescript
// OK: {理由}
const goodExample = () => {
  // 良い実装
};
```

### 2. {パターン名}

**NG例**:
```typescript
// NG: {理由}
const badExample = () => {
  // 悪い実装
};
```

**OK例**:
```typescript
// OK: {理由}
const goodExample = () => {
  // 良い実装
};
```

---

## 禁止ワード

以下の言葉は、ユーザー向けテキストで使ってはいけません。

| 禁止ワード | 理由 | 代替案 |
|-----------|------|--------|
| {ワード1} | {理由} | {代替案} |
| {ワード2} | {理由} | {代替案} |

---

## 過去に問題を起こした実装

### 1. {問題の説明}

**発生日**: {日付}

**原因**: {原因}

**対策**: {対策}

### 2. {問題の説明}

**発生日**: {日付}

**原因**: {原因}

**対策**: {対策}
```

---

## レビューチェックリストテンプレート

PRレビュー時に使用するチェックリストのテンプレートです。

```markdown
# {プロジェクト名} レビューチェックリスト

**PR: {PR番号} - {PR名}**

レビュー日: {日付}
レビュアー: {名前}

---

## 1. NG集チェック

- [ ] 触ってはいけないファイルに触れていない
- [ ] 使ってはいけないライブラリ/関数を使っていない
- [ ] 禁止されている実装パターンを使っていない
- [ ] 禁止ワードを使っていない

---

## 2. コード品質チェック

- [ ] TypeScriptの型エラーがない
- [ ] ESLintエラーがない
- [ ] コードスタイルが統一されている
- [ ] 不要なコメントやデバッグコードがない

---

## 3. テストチェック

- [ ] ユニットテストが追加されている
- [ ] 既存テストが全てパスする
- [ ] テストカバレッジが十分である

---

## 4. 機能チェック

- [ ] 実装内容が仕様通りである
- [ ] エッジケースが考慮されている
- [ ] エラーハンドリングが適切である

---

## 5. デグレードチェック

- [ ] 既存機能が壊れていない
- [ ] UIが崩れていない
- [ ] パフォーマンスが劣化していない

---

## 6. ドキュメントチェック

- [ ] READMEが更新されている（必要な場合）
- [ ] コメントが適切に書かれている
- [ ] 型定義が適切に書かれている

---

## レビュー結果

### ✅ 承認 / ❌ 修正依頼

**コメント**:

{レビューコメント}

---

## 次のアクション

- [ ] {アクション1}
- [ ] {アクション2}
```

---

## 使い方

### 1. プロジェクトに導入

```bash
# プロジェクトルートにdocsディレクトリを作成
mkdir -p docs

# テンプレートをコピー
cp github-workflow-quality-guide.md docs/
cp implementation-guide-template.md docs/implementation-guide.md
cp ng-list-template.md docs/ng-list.md
cp review-checklist-template.md docs/review-checklist-template.md
```

### 2. プロジェクトに合わせてカスタマイズ

- `docs/implementation-guide.md`: プロジェクトの実装ガイドを作成
- `docs/ng-list.md`: プロジェクトのNG集を作成
- `docs/review-checklist-template.md`: プロジェクトのレビューチェックリストを作成

### 3. PRごとにレビューチェックリストを作成

```bash
# PR-1のレビューチェックリストを作成
cp docs/review-checklist-template.md docs/pr1-review-checklist.md
```

### 4. ChatGPTに相談

実装前に、以下のファイルをChatGPTに送って相談します。

- `docs/implementation-guide.md`
- `docs/ng-list.md`
- 実装予定のコード差分

**相談内容例**:
```
以下のPRを実装しようと思います。
実装ガイドとNG集に違反していないか、
デグレードリスクがないか確認してください。

【実装ガイド】
（implementation-guide.mdの内容）

【NG集】
（ng-list.mdの内容）

【実装予定のコード差分】
（git diffの内容）
```

### 5. レビュー実施

PRごとに、レビューチェックリストを使ってレビューします。

```bash
# PR-1のレビューを実施
# docs/pr1-review-checklist.md を埋める
```

### 6. チェックポイント保存

PRが完了したら、チェックポイントを保存します。

```bash
git add .
git commit -m "feat: PR-1完了"
git push
```

---

## 品質が上がる理由

このワークフローを使うと、以下の理由で品質が上がります。

### 1. デグレードを防ぐ

- NG集で「触ってはいけないファイル」を明確化
- レビューチェックリストで既存機能の確認を徹底

### 2. 設計ミスを防ぐ

- 実装前にChatGPTに相談
- PR分割で影響範囲を限定

### 3. レビューしやすくなる

- 小さなPRで変更内容が明確
- レビューチェックリストで確認項目が明確

### 4. ロールバックしやすくなる

- PRごとに独立してロールバック可能
- チェックポイントで過去の状態に戻せる

### 5. ドキュメントが残る

- 実装ガイドで設計思想が明確
- NG集で過去の失敗が共有される

---

## まとめ

このガイドを使うことで、以下のメリットがあります。

1. **品質向上**: デグレードや設計ミスを防ぐ
2. **開発速度向上**: レビューがスムーズになり、手戻りが減る
3. **チーム協働**: ドキュメントが残り、知識が共有される
4. **安心感**: 「どこか直したら他が壊れる」問題が解消される

**どんなプロジェクトでも適用できる**ので、ぜひ使ってみてください！

---

## 参考: Phase 2実装ガイドからの学び

このガイドは、Phase 2実装ガイドで培った以下のノウハウを汎用化したものです。

- FSM（有限状態機械）による状態管理
- PR分割による段階的な実装
- NG集による事故防止
- レビューチェックリストによる品質担保
- ChatGPTへの相談による設計確認

Phase 2実装ガイドの詳細は、`docs/phase2-implementation-guide.md` を参照してください。
