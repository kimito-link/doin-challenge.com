# ã“ã¾ã‚ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã®è©³ç´°è¨­è¨ˆæ›¸

## ğŸ“‹ ç›®çš„

ã€Œ5æ­©é€²ã‚“ã ã‚‰7æ­©ä¸‹ãŒã‚‹ã€å•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã€**ã“ã¾ã‚ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**ã‚’å°å…¥ã™ã‚‹ã€‚
å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ1ã¤ã®å°ã•ãªå¤‰æ›´ã®ã¿ã‚’å«ã‚€ã“ã¨ã§ã€å•é¡Œã®ç‰¹å®šã¨ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå®¹æ˜“ã«ãªã‚‹ã€‚

---

## ğŸ¯ åŸå‰‡

### 1. 1ãƒãƒ¼ã‚¸ãƒ§ãƒ³ = 1å¤‰æ›´

å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ã€ä»¥ä¸‹ã®ã„ãšã‚Œã‹**1ã¤**ã®å¤‰æ›´ã®ã¿ã‚’å«ã‚€ï¼š

- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å±¤ã®å¤‰æ›´ï¼ˆSQLã‚¯ã‚¨ãƒªã®è¿½åŠ ãƒ»ä¿®æ­£ï¼‰
- APIå±¤ã®å¤‰æ›´ï¼ˆé–¢æ•°ã®è¿½åŠ ãƒ»ä¿®æ­£ï¼‰
- UIå±¤ã®å¤‰æ›´ï¼ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¿½åŠ ãƒ»ä¿®æ­£ï¼‰
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´ï¼ˆenv, config, etc.ï¼‰
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å¤‰æ›´

### 2. å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§å¿…ãšãƒ†ã‚¹ãƒˆ

å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ä»¥ä¸‹ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ï¼š

1. **ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ**: å¤‰æ›´ã—ãŸé–¢æ•°ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã‹
2. **çµ±åˆãƒ†ã‚¹ãƒˆ**: æ—¢å­˜ã®æ©Ÿèƒ½ãŒå£Šã‚Œã¦ã„ãªã„ã‹
3. **diff-check**: å±é™ºãªå¤‰æ›´ãŒå«ã¾ã‚Œã¦ã„ãªã„ã‹

### 3. å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§commit + checkpoint

å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ä»¥ä¸‹ã‚’å®Ÿæ–½ï¼š

1. `git add .`
2. `git commit -m "v6.XXX: å¤‰æ›´å†…å®¹ã®è¦ç´„"`
3. `webdev_save_checkpoint`ï¼ˆãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆä½œæˆï¼‰
4. `bash scripts/diff-check.sh`ï¼ˆdiff-checkå®Ÿè¡Œï¼‰

---

## ğŸ“¦ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã®ä»˜ã‘æ–¹

### å½¢å¼

```
v6.XXX
```

- `6`: ãƒ¡ã‚¸ãƒ£ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®å¤§ããªå¤‰æ›´ï¼‰
- `XXX`: ãƒã‚¤ãƒŠãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆå°ã•ãªå¤‰æ›´ã”ã¨ã«ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆï¼‰

### ä¾‹

```
v6.173 â†’ Gate 1å®Ÿè£…å®Œäº†
v6.174 â†’ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å±¤: æ€§åˆ¥çµ±è¨ˆSQLå®Ÿè£…
v6.175 â†’ APIå±¤: challenge-db.tså®Ÿè£…
v6.176 â†’ APIå±¤: events.tsçµ±åˆ
v6.177 â†’ UIå±¤: GenderStatsã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçµ±åˆ
v6.178 â†’ çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†
```

---

## âœ… å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§å®Ÿæ–½ã™ã¹ããƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Phase 1: å¤‰æ›´ã®å®Ÿè£…

- [ ] 1ã¤ã®å¤‰æ›´ã®ã¿ã‚’å®Ÿè£…ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ / API / UI / è¨­å®š / ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰
- [ ] ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆè‡ªåˆ†ã§ç¢ºèªï¼‰

### Phase 2: ãƒ†ã‚¹ãƒˆ

- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆå¤‰æ›´ã—ãŸé–¢æ•°ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆæ—¢å­˜ã®æ©Ÿèƒ½ãŒå£Šã‚Œã¦ã„ãªã„ã‹ï¼‰
- [ ] è¦–è¦šçš„ç¢ºèªï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèªï¼‰

### Phase 3: commit + checkpoint

- [ ] `git add .`
- [ ] `git commit -m "v6.XXX: å¤‰æ›´å†…å®¹ã®è¦ç´„"`
- [ ] `shared/version.ts`ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’æ›´æ–°
- [ ] `webdev_save_checkpoint`ï¼ˆãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆä½œæˆï¼‰

### Phase 4: diff-check

- [ ] `bash scripts/diff-check.sh`ã‚’å®Ÿè¡Œ
- [ ] è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚ŒãŸå ´åˆã€å½±éŸ¿ç¯„å›²ã‚’ç¢ºèª
- [ ] å±é™ºãªå¤‰æ›´ã®å ´åˆã€è¿½åŠ ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½

### Phase 5: æ¬¡ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¸

- [ ] todo.mdã«æ¬¡ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ 
- [ ] æ¬¡ã®å¤‰æ›´ã‚’å®Ÿè£…

---

## ğŸ”— Gate 1ã¨ã®çµ±åˆ

### Gate 1ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ

Gate 1ã¯ã€ä»¥ä¸‹ã®6ã¤ã®å±é™ºãªå¤‰æ›´ã‚’æ¤œçŸ¥ï¼š

1. OAuth / èªè¨¼
2. Deploy / CI
3. Env
4. DB
5. Health
6. Routing / Redirect / Proxy

### ã“ã¾ã‚ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã¨ã®çµ±åˆ

å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§`diff-check.sh`ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€Gate 1ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’é€šéã™ã‚‹ã€‚

```bash
# å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§diff-checkã‚’å®Ÿè¡Œ
bash scripts/diff-check.sh
```

è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚ŒãŸå ´åˆï¼š

1. **OAuth / èªè¨¼**: ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½
2. **Deploy / CI**: Deployå¾Œãƒ˜ãƒ«ã‚¹ç…§åˆã‚’å®Ÿæ–½
3. **Env**: ç’°å¢ƒå¤‰æ•°ã®å¤‰æ›´ã‚’ç¢ºèª
4. **DB**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¢ºèª
5. **Health**: ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç¢ºèª
6. **Routing / Redirect / Proxy**: ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½

---

## ğŸ“Š ãƒ¡ãƒªãƒƒãƒˆ

### 1. å•é¡Œã®ç‰¹å®šãŒå®¹æ˜“

å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ1ã¤ã®å°ã•ãªå¤‰æ›´ã®ã¿ã‚’å«ã‚€ãŸã‚ã€å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã€åŸå› ã‚’ç‰¹å®šã—ã‚„ã™ã„ã€‚

**ä¾‹**:
- v6.177ã§ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒãŒæ¶ˆãˆãŸ â†’ v6.177ã®å¤‰æ›´ï¼ˆGenderStatsã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçµ±åˆï¼‰ãŒåŸå› 

### 2. ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå®‰å…¨

1ã¤å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æˆ»ã‚Œã°ã€ç¢ºå®Ÿã«å‹•ä½œã™ã‚‹çŠ¶æ…‹ã«æˆ»ã‚Œã‚‹ã€‚

**ä¾‹**:
- v6.177ã§å•é¡ŒãŒç™ºç”Ÿ â†’ v6.176ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ â†’ å•é¡ŒãŒè§£æ±º

### 3. å¤‰æ›´å±¥æ­´ãŒæ˜ç¢º

å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®commitãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¦‹ã‚Œã°ã€ä½•ã‚’ã„ã¤å¤‰æ›´ã—ãŸã‹ãŒä¸€ç›®ç­ç„¶ã€‚

**ä¾‹**:
```
v6.174: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å±¤: æ€§åˆ¥çµ±è¨ˆSQLå®Ÿè£…
v6.175: APIå±¤: challenge-db.tså®Ÿè£…
v6.176: APIå±¤: events.tsçµ±åˆ
v6.177: UIå±¤: GenderStatsã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçµ±åˆ
```

### 4. diff-checkãŒåŠ¹æœçš„

å°ã•ãªå¤‰æ›´ãªã®ã§ã€å½±éŸ¿ç¯„å›²ãŒæ˜ç¢ºã€‚diff-checkã®è­¦å‘Šã‚‚ç†è§£ã—ã‚„ã™ã„ã€‚

---

## ğŸš€ å®Ÿè£…ä¾‹: æ€§åˆ¥çµ±è¨ˆè¡¨ç¤ºæ©Ÿèƒ½

### v6.174: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å±¤

```sql
-- æ€§åˆ¥çµ±è¨ˆã‚’é›†è¨ˆã™ã‚‹SQLã‚¯ã‚¨ãƒª
SELECT 
  c.id,
  c.title,
  COUNT(CASE WHEN p.gender = 'male' THEN 1 END) as male_count,
  COUNT(CASE WHEN p.gender = 'female' THEN 1 END) as female_count,
  COUNT(CASE WHEN p.gender = 'unspecified' THEN 1 END) as unspecified_count
FROM challenges c
LEFT JOIN participations p ON c.id = p.challengeId
GROUP BY c.id, c.title
ORDER BY c.id;
```

**ãƒ†ã‚¹ãƒˆ**: SQLã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ã¦çµæœã‚’ç¢ºèª

**commit**: `git commit -m "v6.174: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å±¤: æ€§åˆ¥çµ±è¨ˆSQLå®Ÿè£…"`

**checkpoint**: `webdev_save_checkpoint`

**diff-check**: `bash scripts/diff-check.sh` â†’ DBè­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã‚‹ â†’ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¢ºèª

---

### v6.175: APIå±¤ï¼ˆchallenge-db.tsï¼‰

```typescript
export async function getAllEventsWithGenderStats() {
  const db = await getDb();
  if (!db) return [];
  
  // æ€§åˆ¥çµ±è¨ˆã‚’å«ã‚€ãƒãƒ£ãƒ¬ãƒ³ã‚¸ä¸€è¦§ã‚’å–å¾—
  const result = await db.execute(sql`
    SELECT 
      c.*,
      COUNT(CASE WHEN p.gender = 'male' THEN 1 END) as maleCount,
      COUNT(CASE WHEN p.gender = 'female' THEN 1 END) as femaleCount,
      COUNT(CASE WHEN p.gender = 'unspecified' THEN 1 END) as unspecifiedCount
    FROM challenges c
    LEFT JOIN participations p ON c.id = p.challengeId
    WHERE c.isPublic = true
    GROUP BY c.id
    ORDER BY c.eventDate DESC
  `);
  
  return result[0];
}
```

**ãƒ†ã‚¹ãƒˆ**: APIã‚’å‘¼ã³å‡ºã—ã¦çµæœã‚’ç¢ºèªï¼ˆcurl or Postmanï¼‰

**commit**: `git commit -m "v6.175: APIå±¤: challenge-db.tså®Ÿè£…"`

**checkpoint**: `webdev_save_checkpoint`

**diff-check**: `bash scripts/diff-check.sh` â†’ è­¦å‘Šãªã—

---

### v6.176: APIå±¤ï¼ˆevents.tsçµ±åˆï¼‰

```typescript
listPaginated: publicProcedure
  .input(z.object({ page: z.number().min(1), limit: z.number().min(1).max(100) }))
  .query(async ({ input }) => {
    const events = await getAllEventsWithGenderStats(); // å¤‰æ›´: getAllEvents() â†’ getAllEventsWithGenderStats()
    const start = (input.page - 1) * input.limit;
    const end = start + input.limit;
    return {
      events: events.slice(start, end),
      total: events.length,
    };
  }),
```

**ãƒ†ã‚¹ãƒˆ**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰APIã‚’å‘¼ã³å‡ºã—ã¦çµæœã‚’ç¢ºèª

**commit**: `git commit -m "v6.176: APIå±¤: events.tsçµ±åˆ"`

**checkpoint**: `webdev_save_checkpoint`

**diff-check**: `bash scripts/diff-check.sh` â†’ è­¦å‘Šãªã—

---

### v6.177: UIå±¤ï¼ˆGenderStatsã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçµ±åˆï¼‰

```tsx
<ColorfulChallengeCard
  challenge={{
    ...challenge,
    genderStats: {
      maleCount: challenge.maleCount,
      femaleCount: challenge.femaleCount,
      unspecifiedCount: challenge.unspecifiedCount,
    },
  }}
/>
```

**ãƒ†ã‚¹ãƒˆ**: ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèªï¼ˆã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã¨æ€§åˆ¥çµ±è¨ˆãŒä¸¡æ–¹è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªï¼‰

**commit**: `git commit -m "v6.177: UIå±¤: GenderStatsã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçµ±åˆ"`

**checkpoint**: `webdev_save_checkpoint`

**diff-check**: `bash scripts/diff-check.sh` â†’ è­¦å‘Šãªã—

---

### v6.178: çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†

**ãƒ†ã‚¹ãƒˆ**:
1. ãƒ›ãƒ¼ãƒ ç”»é¢ã§ã‚µãƒ ãƒã‚¤ãƒ«ãƒ»æ€§åˆ¥çµ±è¨ˆãŒä¸¡æ–¹è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
2. ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
3. ãƒãƒ£ãƒ¬ãƒ³ã‚¸è©³ç´°ç”»é¢ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

**commit**: `git commit -m "v6.178: çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†"`

**checkpoint**: `webdev_save_checkpoint`

**diff-check**: `bash scripts/diff-check.sh` â†’ è­¦å‘Šãªã—

---

## ğŸ¯ ã¾ã¨ã‚

ã“ã¾ã‚ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚’å°å…¥ã™ã‚‹ã“ã¨ã§ã€ä»¥ä¸‹ã®ãƒ¡ãƒªãƒƒãƒˆãŒå¾—ã‚‰ã‚Œã‚‹ï¼š

1. **å•é¡Œã®ç‰¹å®šãŒå®¹æ˜“**: å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ1ã¤ã®å°ã•ãªå¤‰æ›´ã®ã¿ã‚’å«ã‚€
2. **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå®‰å…¨**: 1ã¤å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æˆ»ã‚Œã°ç¢ºå®Ÿã«å‹•ã
3. **å¤‰æ›´å±¥æ­´ãŒæ˜ç¢º**: ä½•ã‚’ã„ã¤å¤‰æ›´ã—ãŸã‹ãŒä¸€ç›®ç­ç„¶
4. **diff-checkãŒåŠ¹æœçš„**: å°ã•ãªå¤‰æ›´ãªã®ã§å½±éŸ¿ç¯„å›²ãŒæ˜ç¢º

Gate 1ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã€Œ5æ­©é€²ã‚“ã ã‚‰7æ­©ä¸‹ãŒã‚‹ã€å•é¡Œã‚’æ ¹æœ¬çš„ã«è§£æ±ºã§ãã‚‹ã€‚
