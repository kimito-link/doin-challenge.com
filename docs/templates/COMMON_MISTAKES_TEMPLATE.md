# AIが起こしがちなミス集（汎用テンプレート）

**最終更新**: [日付]

このドキュメントは、**[プロジェクト名]**において、AIが起こしがちなミスと防止策をまとめたものです。

---

## 目次

1. [UI/UXのミス](#uiuxのミス)
2. [プログラムのミス](#プログラムのミス)
3. [データベースのミス](#データベースのミス)
4. [パフォーマンスのミス](#パフォーマンスのミス)
5. [セキュリティのミス](#セキュリティのミス)

---

## UI/UXのミス

### 1. コンポーネントの重複実装

**問題**:
- 同じ機能を持つコンポーネントを複数の場所で実装してしまう
- 例: [具体例]

**防止策**:
- **必ず `[共通コンポーネントのパス]` を使用**
- 新しいコンポーネントを作成する前に、`COMPONENT_REGISTRY.md`を確認
- `DESIGN_PRINCIPLES.md`の「[関連する設計原則]」を厳守

**チェックリスト**:
- [ ] `[共通コンポーネントのパス]`を使用しているか？
- [ ] 新しいコンポーネントを作成していないか？
- [ ] `COMPONENT_REGISTRY.md`を確認したか？

---

### 2. コントラスト比が低い

**問題**:
- 背景色とテキスト色のコントラスト比が低く、視認性が悪い
- WCAG 2.1 AA基準（コントラスト比4.5:1以上）を満たさない

**防止策**:
- **WCAG 2.1 AA基準を満たすように設計**
- コントラスト比チェッカーを使用して確認
- 例: [WebAIM Contrast Checker](https://webaim.org/resources/contrastchecker/)

**チェックリスト**:
- [ ] WCAG 2.1 AA基準を満たしているか？
- [ ] コントラスト比チェッカーで確認したか？

---

### 3. 画像が表示されない

**問題**:
- 画像のパスが間違っている
- 画像が存在しない
- 画像の読み込みエラーが発生

**防止策**:
- **画像のパスを確認**
- **フォールバック画像を設定**
- **エラーハンドリングを実装**

**チェックリスト**:
- [ ] 画像のパスは正しいか？
- [ ] フォールバック画像を設定したか？
- [ ] エラーハンドリングを実装したか？

---

## プログラムのミス

### 1. TypeScript型エラー

**問題**:
- プロパティが存在しない
- 型が一致しない
- TypeScriptエラーを無視してしまう

**防止策**:
- **型定義を確認**
- **TypeScriptエラーを無視せず、必ず修正**
- **`any`型を使用しない**

**チェックリスト**:
- [ ] 型定義を確認したか？
- [ ] TypeScriptエラーを修正したか？
- [ ] `any`型を使用していないか？

---

### 2. 非同期処理のエラーハンドリング不足

**問題**:
- `async/await`を使用しているが、エラーハンドリングがない
- ネットワークエラーやタイムアウトが発生したとき、アプリがクラッシュする

**防止策**:
- **必ず`try/catch`を使用**
- エラーメッセージをユーザーに表示
- エラーログを記録

**チェックリスト**:
- [ ] `try/catch`を使用しているか？
- [ ] エラーメッセージをユーザーに表示しているか？
- [ ] エラーログを記録しているか？

---

### 3. 状態管理の不整合

**問題**:
- ローカルストレージに保存した状態と、メモリ上の状態が一致しない
- ログアウト後も、古い状態が残っている

**防止策**:
- **状態を更新したら、必ずローカルストレージに保存**
- ログアウト時は、ローカルストレージをクリア
- 初期化時にローカルストレージから読み込む

**チェックリスト**:
- [ ] 状態を更新したら、ローカルストレージに保存しているか？
- [ ] ログアウト時にローカルストレージをクリアしているか？
- [ ] 初期化時にローカルストレージから読み込んでいるか？

---

## データベースのミス

### 1. 外部キー制約違反

**問題**:
- 存在しないレコードを参照してしまう
- データベースエラーが発生

**防止策**:
- **外部キー制約を設定**
- データを挿入する前に、参照先のレコードが存在するか確認

**チェックリスト**:
- [ ] 外部キー制約を設定しているか？
- [ ] 参照先のレコードが存在するか確認しているか？

---

### 2. NULL値の扱い

**問題**:
- `NULL`値を正しく扱っていない
- フロントエンドで空文字列（`""`）として扱われる

**防止策**:
- **データベースで`NULL`を許可する場合、フロントエンドで`null`または`undefined`として扱う**
- 空文字列（`""`）を`NULL`に変換

**チェックリスト**:
- [ ] `NULL`値を正しく扱っているか？
- [ ] 空文字列を`NULL`に変換しているか？

---

## パフォーマンスのミス

### 1. 大量のデータを一度に表示

**問題**:
- 大量のアイテムを一度に表示してしまう
- パフォーマンスが低下し、スクロールが遅くなる

**防止策**:
- **仮想スクロール（Virtual Scrolling）を使用**
- **ページネーションを実装**
- **無限スクロールを実装**

**チェックリスト**:
- [ ] 仮想スクロールを使用しているか？
- [ ] ページネーションを実装しているか？
- [ ] 無限スクロールを実装しているか？

---

### 2. 画像の最適化不足

**問題**:
- 高解像度の画像をそのまま表示してしまう
- 読み込みが遅く、メモリを大量に消費

**防止策**:
- **画像を最適化**
- **サムネイル画像を生成**
- **遅延読み込み（Lazy Loading）を実装**

**チェックリスト**:
- [ ] 画像を最適化しているか？
- [ ] サムネイル画像を生成しているか？
- [ ] 遅延読み込みを実装しているか？

---

## セキュリティのミス

### 1. XSS（クロスサイトスクリプティング）

**問題**:
- ユーザー入力をそのままHTMLに表示してしまう
- 悪意のあるスクリプトが実行される

**防止策**:
- **ユーザー入力をエスケープ**
- **`dangerouslySetInnerHTML`を使用しない**
- **Content Security Policy (CSP) を設定**

**チェックリスト**:
- [ ] ユーザー入力をエスケープしているか？
- [ ] `dangerouslySetInnerHTML`を使用していないか？
- [ ] Content Security Policy (CSP) を設定しているか？

---

### 2. SQL Injection

**問題**:
- ユーザー入力をそのままSQLクエリに埋め込んでしまう
- データベースが改ざんされる

**防止策**:
- **ORMを使用**（自動的にエスケープされる）
- **プリペアドステートメントを使用**
- **生のSQLクエリを使用しない**

**チェックリスト**:
- [ ] ORMを使用しているか？
- [ ] プリペアドステートメントを使用しているか？
- [ ] 生のSQLクエリを使用していないか？

---

## 実装前のチェックリスト

新しい機能を実装する前に、以下を確認すること:

1. [ ] `DESIGN_PRINCIPLES.md`を読んだか？
2. [ ] `COMPONENT_REGISTRY.md`を確認したか？
3. [ ] `AI_INSTRUCTIONS.md`を読んだか？
4. [ ] 同じ機能が既に実装されていないか？
5. [ ] 既存のコンポーネントを再利用できないか？
6. [ ] TypeScriptエラーを確認したか？
7. [ ] エラーハンドリングを実装したか？
8. [ ] パフォーマンスを考慮したか？
9. [ ] セキュリティを考慮したか？

---

## 実装後のチェックリスト

実装完了後、以下を確認すること:

1. [ ] TypeScriptエラーがないか？
2. [ ] 開発サーバーが正常に起動するか？
3. [ ] 本番環境でテストしたか？
4. [ ] `COMPONENT_REGISTRY.md`を更新したか？（新しいコンポーネントを作成した場合）
5. [ ] `todo.md`を更新したか？
6. [ ] チェックポイントを作成したか？

---

## 参考資料

- [DESIGN_PRINCIPLES.md](../DESIGN_PRINCIPLES.md): 設計原則
- [COMPONENT_REGISTRY.md](./COMPONENT_REGISTRY.md): コンポーネント一覧
- [AI_INSTRUCTIONS.md](./AI_INSTRUCTIONS.md): AI実装ガイドライン

---

## 使用方法

### 1. このテンプレートをコピー

```bash
cp docs/templates/COMMON_MISTAKES_TEMPLATE.md docs/COMMON_MISTAKES.md
```

### 2. プロジェクト固有の情報を追加

- `[プロジェクト名]` → 実際のプロジェクト名
- `[具体例]` → プロジェクト固有の具体例
- `[共通コンポーネントのパス]` → 実際のコンポーネントパス
- `[関連する設計原則]` → 実際の設計原則

### 3. プロジェクト固有のミスを追加

- プロジェクトで実際に発生したミスを追加
- 防止策とチェックリストを追加

### 4. 定期的に更新

- 新しいミスが発生したら、このファイルに追加
- 防止策が有効だったかを確認し、必要に応じて更新

---

**最終更新**: [日付]
